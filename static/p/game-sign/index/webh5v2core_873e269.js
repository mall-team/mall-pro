!function(){function e(){}function t(e,t){if(t)return"'"+e.split("'").join("\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")+"'";var n=e.charAt(0),i=e.substring(1);return"="===n?"+("+i+")+":":"===n?"+e("+i+")+":";"+e+";o+="}var n=window.hfive=window.hfive||{},i=function(){var e;if(window.Zepto)e=window.Zepto,e.fn.prop=e.fn.attr,Event.prototype.isDefaultPrevented=function(){return this.defaultPrevented};else{if(!window.jQuery)throw"Either Zepto or jQuery is required but neither can be found.";e=window.jQuery}return e}(),o=Math,r={},s={},c={};e.extend=function(e){var t,n,a=function(){},o=this,r=e&&e.init?e.init:function(){o.apply(this,arguments)};a.prototype=o.prototype,n=r.fn=r.prototype=i.extend(new a,e);for(t in n)"object"==typeof n[t]&&(n[t]=i.extend({},a.prototype[t],e[t]));return n.constructor=r,r.extend=o.extend,r};var d=e.extend({init:function(){this._events={}},bind:function(e,t,n){var a,o,r,s,c,d=this,l=i.isArray(e)?e:[e];for(a=0,o=l.length;o>a;a++)e=l[a],(r=i.isFunction(t)?t:t[e])&&(n&&(s=r,r=function(){d.unbind(e,r),s.call(d,arguments)}),c=d._events[e]||[],c.push(r),d._events[e]=c);return d},one:function(e,t){return this.bind(e,t,!0)},trigger:function(e,t){var n,a,o=this._events[e],r=!1,s=i.extend(t,{preventDefault:function(){r=!0},isDefaultPrevented:function(){return r}});if(o)for(n=0,a=o.length;a>n;n++)o[n].call(this,s);return r},unbind:function(e,t){var n,i,a=this._events[e];if(a)if(t)for(n=0,i=a.length;i>n;n++)a[n]===t&&a.splice(n,1);else this._events[e]=[];return this}}),l=/^\w+/,u=/\${([^}]*)}/g,h=/\\}/g,p=/__CURLY__/g,m=/\\#/g,f=/__SHARP__/g;Template={paramName:"data",useWithBlock:!0,render:function(e,t){var n,i,a="";for(n=0,i=t.length;i>n;n++)a+=e(t[n]);return a},compile:function(e,n){var a,o=i.extend({},this,n),r=o.paramName,s=r.match(l)[0],o=o.useWithBlock,c="var o,e=hfive.htmlEncode;";if(i.isFunction(e))return 2===e.length?function(t){return e(i,{data:t}).join("")}:e;for(c=c+(o?"with("+r+"){":"")+"o=",r=e.replace(h,"__CURLY__").replace(u,"#=e($1)#").replace(p,"}").replace(m,"__SHARP__").split("#"),a=0;a<r.length;a++)c+=t(r[a],0===a%2);c+=o?";}":";",c+="return o;",c=c.replace(f,"#");try{return new Function(s,c)}catch(d){throw Error("Invalid template")}}};var g=d.extend({init:function(e,t){this.element=i(e),d.fn.init.call(this),this.options=i.extend({},this.options,t),this.element.attr(n.attr("role"))||this.element.attr(n.attr("role"),(this.options.name||"").toLowerCase())}});c.mobileOS=function(e){var t,n=!1,i=[],a={fire:/(Silk)\/(\d+)\.(\d+(\.\d+)?)/,android:/(Android)\s+(\d+)\.(\d+(\.\d+)?)/,iphone:/(iPhone|iPod).*OS\s+(\d+)[\._]([\d\._]+)/,ipad:/(iPad).*OS\s+(\d+)[\._]([\d_]+)/,meego:/(MeeGo).+NokiaBrowser\/(\d+)\.([\d\._]+)/,webos:/(webOS)\/(\d+)\.(\d+(\.\d+)?)/,blackberry:/(BlackBerry|PlayBook).*?Version\/(\d+)\.(\d+(\.\d+)?)/},o={ios:/^i(phone|pad|pod)$/i,android:/^android|fire$/i};for(t in a)if(a.hasOwnProperty(t)&&(i=e.match(a[t]))){n={},n.device=t,a=n;e:{var r=void 0;for(r in o)if(o.hasOwnProperty(r)&&o[r].test(t)){o=r;break e}o=t}a.name=o,n[n.name]=!0,n.majorVersion=i[2],n.minorVersion=i[3].replace("_","."),n.flatVersion=n.majorVersion+n.minorVersion.replace(".",""),n.flatVersion+=Array(4-n.flatVersion.length).join("0"),n.appMode=window.navigator.standalone||"undefined"!=typeof window._nativeReady;break}return e=e.match(/(MicroMessenger)\/(\d+)\.(\d+(\.\d+)?)/),n.isMicroMessenger=!1,e&&(n.isMicroMessenger=!0,n.mmMajorVersion=e[2],n.mmMinorVersion=e[3].replace("_",".")),n}(navigator.userAgent),c.animationEvents="undefined"!=typeof window.WebKitAnimationEvent,c.touch="ontouchstart"in window,c.ios5=c.mobileOS.ios&&410<=c.mobileOS.flatVersion,c.animationEnd="webkit moz o ms khtml ".split(" ").join("AnimationEnd ")+"animationEnd",c.touch?(c.mousedown="touchstart",c.mouseup="touchend",c.mousemove="touchmove",c.mousecancel="touchcancel"):(c.mousemove="mousemove",c.mousedown="mousedown",c.mouseup="mouseup",c.mousecancel="mouseleave"),commonDictionarySplit=function(e,t,n){"undefined"==typeof t&&(t="&"),"undefined"==typeof n&&(n="");var i=RegExp("^"+n+"|"+n+"$","g");if("string"==typeof e){e=e.split(n+t),n={};for(var a=0,o=e.length;o>a;a++)t=e[a].split("="),1<t.length?n[t[0]]=t.slice(1).join("=").replace(i,""):n[e[a]]=!0;return n}return{}},splitHttpParamString=function(e){return commonDictionarySplit(e,"&")},getHashes=function(){return splitHttpParamString(location.hash.substr(1))};var w=/template$/i,y=/^\s*(?:\{(?:.|\n)*\}|\[(?:.|\n)*\])\s*$/,v=/^\{(\d+)(:[^\}]+)?\}/,D=/([A-Z])/g;i.extend(n,{$:i,ui:{},support:c,ns:"",Observable:d,Class:e,noop:function(){},htmlEncode:function(e){return(""+e).replace(ampRegExp,"&amp;").replace(ltRegExp,"&lt;").replace(gtRegExp,"&gt;")},Template:Template,template:i.proxy(Template.compile,Template),render:i.proxy(Template.render,Template),parseOptions:function(e,t){var a,o,r={};for(a in t){o=e;var s=a,c=void 0;0===s.indexOf("data")&&(s=s.substring(4),s=s.charAt(0).toLowerCase()+s.substring(1)),s=s.replace(D,"-$1"),c=o.getAttribute("data-"+n.ns+s),null===c?c=void 0:"null"===c?c=null:"true"===c?c=!0:"false"===c?c=!1:isNaN(parseFloat(c))?y.test(c)&&!v.test(c)&&(c=i.parseJSON(c)):c=parseFloat(c),o=c,void 0!==o&&(w.test(a)&&(o=n.template(i("#"+o).html())),r[a]=o)}return r},attr:function(e){return"data-"+n.ns+e},parseJson:function(e){return null===e?null:JSON.parse(e)},splitHttpParamString:splitHttpParamString,commonDictionarySplit:commonDictionarySplit,getHashes:getHashes,guid:function(){var e,t,n="";for(e=0;32>e;e++)t=16*o.random()|0,(8==e||12==e||16==e||20==e)&&(n+="-"),n+=(12==e?4:16==e?3&t|8:t).toString(16);return n},expr:function(e,t){if((e=e||"")&&"["!==e.charAt(0)&&(e="."+e),t){var n,i,a,o,r=e.split("."),s="d",c=1;for(i=0,a=r.length;a>i;i++)o=r[i],""!==o&&(n=o.indexOf("["),0!==n&&(-1==n?o="."+o:(c++,o="."+o.substring(0,n)+" || {})"+o.substring(n))),c++,s+=o+(a-1>i?" || {})":")"));e=Array(c).join("(")+s}else e="d"+e;return e},getter:function(e,t){return r[e]=r[e]||new Function("d","return "+n.expr(e,t))},setter:function(e){return s[e]=s[e]||new Function("d,value","d."+e+"=value")}}),n.cookie=function(e,t,n){if("undefined"==typeof t){if(t=null,document.cookie&&""!=document.cookie)for(n=document.cookie.split(";"),a=0;a<n.length;a++)if(o=i.trim(n[a]),o.substring(0,e.length+1)==e+"="){t=decodeURIComponent(o.substring(e.length+1));break}return t}n=n||{},null===t&&(t="",n=i.extend({},n),n.expires=-1);var a="";n.expires&&("number"==typeof n.expires||n.expires.toUTCString)&&("number"==typeof n.expires?(a=new Date,a.setTime(a.getTime()+864e5*n.expires)):a=n.expires,a="; expires="+a.toUTCString());var o=n.path?"; path="+n.path:"",r=n.domain?"; domain="+n.domain:"";n=n.secure?"; secure":"",document.cookie=[e,"=",encodeURIComponent(t),a,o,r,n].join("")},n.urlQuery=function(){var e=function(){var e=this;return e.keys={},i.each(arguments,function(){var t;t=(""+this).replace(/^[?#]/,""),t=t.replace(/[;&]$/,""),i.each(t.split(/[&;]/),function(){var t=decodeURIComponent(this.split("=")[0]||""),n=decodeURIComponent(this.split("=")[1]||"");t&&e.SET(t,n)})}),e};return e.prototype={queryObject:!0,get:function(e){return this.keys[e]},SET:function(e,t){return this.keys[e]=t,this}},new e(location.search,location.hash)},n.queue=function(){var e=function(){var e=this;interval=setInterval(function(){if(0<e.Queue.length&&!a.stop){var t=e.Queue.shift();t.fn(t.argument),t.callBack&&t.callBack()}else clearInterval(interval)},this.setTimeout)};return{Queue:[],syncQueue:[],setTimeout:500,add:function(e,t,n){return this.Queue.push({fn:e,argument:t,callBack:n}),this},addSync:function(e,t,n){return this.syncQueue.push({fn:e,argument:t,callBack:n}),this},clear:function(){return this.Queue=[],this},stop:!1,start:function(){return this.stop=!1,0<this.setTimeout&&e.apply(this),this},shift:function(){},dequeue:function(){var e=this.syncQueue.shift();e&&(e.fn(e.argument),e.callBack&&e.callBack())}}}(),n.localStorage=function(){var e=["h5app"];return{setItem:function(t,n,a){-1!=i.inArray(t,e)&&localStorage.setItem(t+"_"+n,a)},getItem:function(t,n){return-1!=i.inArray(t,e)?localStorage.getItem(t+"_"+n):null},removeItem:function(t,n){return-1!=i.inArray(t,e)?localStorage.removeItem(t+"_"+n):null}}}(),n.linkfocus=function(){function e(e){e.removeEventListener("touchend",a,!1),e.removeEventListener("touchmove",n,!1)}function t(){this.addEventListener("touchend",a,!1),this.addEventListener("touchmove",n,!1)}function n(){e(this)}function a(){var t=this;t.className+=" c-linkfocus-active",setTimeout(function(){t.className=t.className.replace(" c-linkfocus-active",""),e(t)},200)}var o=navigator.appVersion,r=/webkit/gi,s=/android/gi;return function(e){if(r.test(o)&&s.test(o)){var n=document.styleSheets[0];n.addRule("*","-webkit-tap-highlight-color:rgba(0,0,0,0);"),!1!==e&&(n.addRule(".c-linkfocus","-webkit-mask:none;"),n.addRule(".c-linkfocus-move","-webkit-mask:none;"),n.addRule(".c-linkfocus-active","background:transparent!important;background-color:transparent!important;-webkit-mask-clip: content-box;-webkit-mask-origin: content;-webkit-mask-repeat: no-repeat;-webkit-border-radius: 3px;-webkit-mask-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(rgba(0,0,0,0.3)), to(rgba(0,0,0,0.3)));"),"string"==typeof e?i(document).on("touchstart",e||'*[class~="c-linkfocus"]',t):"object"==typeof e&&i(e).on("touchstart",t))}}}();var c=e.extend({init:function(e){var t=this;this.settings=i.extend({messages:{},groups:{},rules:{},errorClass:"error",ignore:":hidden",debug:!1},e),this.settings.debug&&!this.settings.cntr&&window.console&&console.log("No cntr property found. "),this.form=this.settings.cntr,this.errors=[],this.elements().each(function(){i(this).on("focusin",function(e){i(e.target).removeClass(t.settings.errorClass)})})},validate:function(){var e=this;return this.errors=[],this.elements().each(function(){e.check(this)}),this.showErrors(this.errors),0==this.errors.length},check:function(e){var t,n=this.elementRules(e.name);for(t in n){var i={method:t,parameters:n[t]};try{if(!this.methods[t].call(this,e.value.replace(/\r/g,""),e,i.parameters))return this.formatAndAdd(e,i),!1}catch(a){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+e.id+", check the '"+i.method+"' method",a),a}}return!0},elementRules:function(e){return this.settings.rules[e]},elements:function(){var e=this,t={};return i(this.form).find("input, select, textarea").filter(function(){return!this.name&&e.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in t||!e.elementRules(this.name)?!1:t[this.name]=!0})},formatAndAdd:function(e,t){var n="",i=this.settings.messages[e.name];i&&i[t.method]&&(n=i[t.method]),this.errors.push({message:n,element:e,rule:t})},showErrors:function(e){if(e){this.settings.showErrors?this.settings.showErrors.call(this,this.errors):this.defaultShowErrors(e);var t,i="";for(t in e)e[t].message&&(i+=e[t].message+"<br/>");""!=i&&n.ui.showWindow("<span>"+i+"</span>",{title:"",width:280,height:48,modal:!0,actions:[{name:"关闭",callback:function(){n.ui.hideWindow()}}]})}},defaultShowErrors:function(){for(var e in this.errors)i(this.errors[e].element).addClass(this.settings.errorClass)},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(e){return i("[name="+e+"]",this.form)},getLength:function(e,t){switch(t.nodeName.toLowerCase()){case"select":return i("option:selected",t).length;case"input":if(this.checkable(t))return this.findByName(t.name).filter(":checked").length}return e.length},methods:{required:function(e,t){switch(t.nodeName.toLowerCase()){case"select":return(e=i(t).val())&&0<e.length;case"input":if(this.checkable(t))return 0<this.getLength(e,t);default:return 0<i.trim(e).length}}}}),M={};i.extend(n.ui,{Validator:c,progress:function(e,t,n){var a=e.find(".h5-loading-mask");t?a.length||i("<div class='h5-loading-mask "+(n?n:"")+"'><img src='/css/image/loading.gif'/><div>正在加载....</div></div>").width("100%").height("100%").prependTo(e):a&&a.remove()},showToast:function(e,t){/^[0-9]*[1-9][0-9]*$/.test(t)||(t=1e3);var n=i("div.h5-toast");if(0>=n.length&&(n=i("<div class='h5-toast' flag=0><p></p></div>").appendTo(i("body"))),1!=n.attr("flag")){n.attr("flag",1),i("p",n).text(e),n.animate({display:"block",opacity:1},200,"ease-in");var a=setInterval(function(){n.animate({opacity:0},200,"ease-in",function(){n.hide(),n.attr("flag",0)}),clearInterval(a)},t)}},showTips:function(e,t,a,o){var r=i("div.h5-tips");0==r.length&&(r=i("<div class='h5-tips' style='position:absolute;width:160px;height:40px;z-index:100000;text-align:center;'><div id='tipsSpan' class='tips-msg'></div></div>").appendTo(i("body"))),i("img",r).remove(),null!=t&&"loading"!=t||i("<img src='/css/image/loading.gif' />").prependTo(r),i("#tipsSpan",r).html(e),e=i(window).scrollTop()+(i(window).height()-40)/2-50,t=0+(i(window).width()-200)/2,r.css({top:e+"px",left:t+"px"}).show(),n.ui._overlay(!0,r),a&&setTimeout(function(){i("div.h5-tips").hide(),i.isFunction(o)&&o()},a)},hideTips:function(){n.ui._overlay(!1,i("div.h5-tips")),i("div.h5-tips").hide()},doAction:function(e,t){return null==e&&(e="global"),M[e]?(console.log("do Action: "+e+" is running."),!1):(console.log("do Action: "+e),M[e]={},t&&setTimeout(function(){M[e]&&n.ui.showTips(t)},1e3),!0)},isActionRunning:function(e){return null==e&&(e="global"),null!=M[e]},actionDone:function(e){null==e&&(e="global"),console.log("do Action: "+e+" done."),n.ui.hideTips(),M[e]&&(M[e]=null)},_overlay:function(e,t){var n=i("body > .h5-overlay");return i(document),0==n.length?n=i("<div class='h5-overlay'/>").toggle(e).insertBefore(t):n.insertBefore(t).toggle(e),n},showWindow:function(e,t){var a=i("div.h5-window"),o=t.closeCallback;0==a.length&&(a=i("<div class='h5-window' style='position:absolute;'><div class='h5-window-title'><span class='title'></span><a href='javascript:;' class='close'><span class='icon icon-close close'></span></a></div><div class='h5-window-content'></div><div class='h5-window-bottom'><div class='h5-window-buttons'></div></div></div>").appendTo(i("body")),i("a.close",a).bind("click",function(){n.ui.hideWindow(),i.isFunction(o)&&o()}));var r=i(window).scrollTop(),s=t&&t.width?t.width:320,c=t&&t.height?t.height:80,d=s+14,l=c+(t&&t.actions?80:40),r=r+(i(window).height()-l)/2,u=0+(i(window).width()-d)/2;i("div.h5-window-content",a).css({width:s+"px",height:c+"px"}),t&&t.title&&i("span.title",a).text(t.title),i("div.h5-window-content",a).html(i(e)),i("div.h5-window-buttons",a).empty(),t&&t.actions&&i.each(t.actions,function(){var e=i("<a href='javascript:;' class='h5-button' style='margin-right:.5em;font-size:0.7em;'>"+this.name+"</a>");e.bind("click",this.callback),i("div.h5-window-buttons",a).append(e)}),t.modal&&n.ui._overlay(!0,a),a.css({width:d+"px",height:l+"px",top:r+"px",left:u+"px"}).show()},hideWindow:function(){n.ui._overlay(!1,i("div.h5-window")),i("div.h5-window").hide()},lazyImgLoad:function(e){e.attr("flag")||(e.find("img.lazyImg").each(function(e,t){t=i(t),(src=t.data("img"))&&t.attr("src",src).removeAttr("data-img").removeClass("lazyImg"),t.data("name")&&"topImg"==t.data("name")&&t.bind("load",function(){i(this).css("width","100%")})}),e.attr("flag","1"))},lazyImgLoad2:function(e){for(var t=0;t<e.length;t++){var n=i(e[t]);n.attr("flag")||(n.find("img.lazyImg").each(function(e,t){t=i(t),src=t.data("img");var n=new Image;n.src=src,n.complete?(t.attr("src",n.src).removeAttr("data-img").removeClass("lazyImg"),delete n):i(n).on("load",i.proxy(function(){this.item.attr("src",this.img.src).removeAttr("data-img").removeClass("lazyImg"),i(this.img).off("load"),delete this.img},{item:t,img:n}))}),n.attr("flag","1"))}},Widget:g,plugin:function(e,t,a){var o=e.fn.options.name;t=t||n.ui,t[o]=e,o="hfive"+(a||"")+o,i.fn[o]=function(t){return i(this).each(function(){var n=new e(this,t);i(this).get(0)[o]=n,i.fn.hfiveWidget=function(){return i(this).get(0)[o]}}),this}}}),i(document).ready(function(){var e,t,a,o;e=document.getElementsByTagName("head")[0],t=document.body,a=document.createElement("style"),a.textContent="@media (transform-3d),(-o-transform-3d),(-moz-transform-3d),(-webkit-transform-3d){#hfive-3dtest{height:3px}}",o=document.createElement("div"),o.id="hfive-3dtest",e.appendChild(a),t.appendChild(o),e=3===o.offsetHeight,a.parentNode.removeChild(a),o.parentNode.removeChild(o),i.extend(n.support,{transform3d:e,translateStart:e?"translate3d(":"translate(",translateEnd:e?",0)":")"})})}(),function(){var e=window.hfive,t=e.$,n="function",i="boolean",a=t.isFunction;t.hfiveMobile=function(o){function r(t){t=e.getHashes(location.hash);var o=h.getView(t.view);if(null==o)0>=m.length&&s(h.defaultView&&a(h.defaultView)?h.defaultView():h.views[0].name);else{var r=!0;o&&o.checkView&&a(o.checkView)&&(r=o.checkView({target:t}));var c=typeof r;i===c&&1==r?d(t):n===c?r.call(o):h.getErrorAction&&a(h.getErrorAction)&&s(h.getErrorAction())}}function s(e){var n={};"string"==typeof e?n.view=e:"object"==typeof e&&(n=e),n&&n.view&&null!=h.getView(n.view)&&(window.location.hash=t.param(n))}function c(e,t){var n=h.getView(e.view);null!=n&&n&&n.initView&&a(n.initView)&&(h.attachHeader&&a(h.attachHeader)&&h.attachHeader({target:e,from:t}),n.initView({target:e,from:t}))}function d(e){var n=e.view;if(null!=h.getView(n)){for(var i=0,o=h.views.length;o>i;i++)h.views[i].view.hide();n=t("#"+n+"View"),n.show();var r=m[m.length-1];if(m.push(e),1==m.length)n.css({left:0}),c(e,null);else if(r&&r.view!=e.view){var s=t("#"+r.view+"View");s.show(),n=h.getViewIndex(r.view),i=h.getViewIndex(e.view),o={},i>n?o.marginLeft="-100%":(u.css("marginLeft","-100%"),o.marginLeft="0"),u.animate(o,{duration:200,complete:function(){u.css("margin",0),s.hide();var t=h.getView(r.view);null!=t&&t&&t.unloadView&&a(t.unloadView)&&t.unloadView({target:e,current:r}),c(e,r)}})}}}var l,u,h,p=t("head"),m=[],f={},g={},w="",y={addGlossToIcon:!0,debug:!1,fixedViewport:!0,formSelector:"form",fullScreen:!0,fullScreenClass:"fullscreen",icon:null,icon4:null,preloadImages:!1,startupScreen:null,statusBar:"default"};return function(n){if(f=t.extend({},y,n),h=f.app,f.preloadImages)for(n=f.preloadImages.length-1;n>=0;n--)(new Image).src=f.preloadImages[n];n=f.addGlossToIcon?"":"-precomposed",f.icon&&(w+='<link rel="apple-touch-icon'+n+'" href="'+f.icon+'" />'),f.icon4&&(w+='<link rel="apple-touch-icon'+n+'" sizes="114x114" href="'+f.icon4+'" />'),f.startupScreen&&(w+='<link rel="apple-touch-startup-image" href="'+f.startupScreen+'" />'),f.fullScreen&&(w+='<meta name="apple-mobile-web-app-capable" content="yes" />',f.statusBar&&(w+='<meta name="apple-mobile-web-app-status-bar-style" content="'+f.statusBar+'" />')),w&&p.prepend(w),n=e.support.mobileOS,n.isMicroMessenger&&"ios"==n.name&&t("body").addClass("ios"+e.support.mobileOS.mmMajorVersion+e.support.mobileOS.mmMinorVersion.replace(".",""))}(o),t(document).ready(function(){if(t.fn.makeActive=function(){return t(this).addClass("active")},t.fn.unselect=function(e){e?e.removeClass("active"):t(".active").removeClass("active")},t(window).bind("hashchange",r),u=t("#viewLayout"),0===u.length){l=t("<div id='wrapper'></div>"),u=t("<div id='viewLayout' style='width:200%'></div>"),l.append(u),t(document.body).prepend(l);for(var e=0,n=h.views.length;n>e;e++){var i=h.views[e].name,i=t("#"+i+"View");i.css({width:"50%","float":"left"}),i.appendTo(u)}}else for(l=t("#wrapper"),u.css({width:"200%"}),e=0,n=h.views.length;n>e;e++)i=h.views[e].name,i=t("#"+i+"View"),i.css({width:"50%","float":"left"});r()}),g={goBack:function(){var e=m[m.length-1],t=h.getView(e.view);t&&t.historyGoBack&&a(t.historyGoBack)?checkResult=t.historyGoBack({target:e}):window.history.go(-1)},goToView:s,history:m,settings:f}};var o=e.Observable.extend({loaded:!1,init:function(n){e.Observable.fn.init.call(this),this.name=n.name,this.app=n.app,this.view=t("#"+n.name+"View")},initView:function(e){0>=this.view.length?this.doLoadView2(t.proxy(this.onViewReloaded,this),e):this._internalInitView(e)},onViewReloaded:function(e){var n=this.app;this.view=t("#"+this.name+"View"),this.view.show(),n.attachHeader&&a(n.attachHeader)&&n.attachHeader(e),this._internalInitView(e)},_internalInitView:function(e){this.loaded||(this.initCom&&a(this.initCom)&&this.initCom(e),this.loaded=!0),this.showView&&a(this.showView)&&this.showView(e),t("a[data-target-view]").bind("click",t.proxy(this.onTargetViewHrefClick,this))},onTargetViewHrefClick:function(e){e=t(e.currentTarget).data("target-view"),this.app.goToView(e)}}),r=e.Observable.extend({init:function(){e.Observable.fn.init.call(this)},initPage:function(e,n){this.hfiveMobile=new t.hfiveMobile(e),this.views=n},getView:function(e){for(var t=0;t<this.views.length;t++)if(this.views[t].name==e)return this.views[t];return null},getViewIndex:function(e){for(var t=0;t<this.views.length;t++)if(this.views[t].name==e)return t;return-1},goBack:function(){this.hfiveMobile.goBack()},goToView:function(e){this.hfiveMobile.goToView(e)},history:function(){this.hfiveMobile.history()},settings:function(){return this.hfiveMobile.settings}});e.BasePage=r,e.BaseView=o}(),function(){var e=window.hfive,t=e.$,n=e.ui.Widget,i=n.extend({init:function(e,t){n.fn.init.call(this,e,t),this._wrap(),this.bind(["startDateChanged","endDateChanged","dateSelected"],t)},options:{name:"Calendar",singleDate:!0,firstDayOfWeek:0,localizedDate:{days:{names:{min:"日一二三四五六".split("")}},months:{names:{"long":"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" ")}}}},_wrap:function(){var n=this;n.dateInfo=n.options.localizedDate,n.calendar=t('<div class="h5-calendar"></div>'),n.element.append(n.calendar),n.previous=t("<a>&lt;</a>"),n.next=t("<a>&gt;</a>"),n.month=t('<li class="h5-cal-month"></li>'),n.calendar.append(t('<ul class="h5-cal-buttonBar"></ul>').append(t('<li class="h5-cal-previous"></li>').append(n.previous)).append(n.month).append(t('<li class="h5-cal-next"></li>').append(n.next)));for(var i=0,a="",o="";7>i;i++)a+="<th><span></span></th>",o+="<td><a></a></td>";for(var i=0,r="";6>i;i++)r+="<tr>"+o+"</tr>";if(n.calendar.append('<div class="h5-cal-grid"><table><thead><tr>'+a+"</tr></thead><tbody>"+r+"</tbody></table></div>"),weekdays=n.calendar.find("th span"),n.dateInfo)for(i=0,a=weekdays.length;a>i;i++)weekdays.eq(n._getDay(i)).text(n.dateInfo.days.names.min[i]);n.days=n.calendar.find("td a"),n.rows=n.calendar.find("tr"),n.rows.eq(1).addClass("first"),n.table=n.calendar.find("table"),n.days.bind("click",t.proxy(n._dateSelected,n)),today=(new Date).clearTime(),n.minDate=today,n.startDate=n.options.startDate?new Date(n.options.startDate).clearTime():null,n.endDate=n.options.endDate?new Date(n.options.endDate).clearTime():null,n.currentMonth=(n.startDate||today).clone(),n.monthGrid=n.calendar.find(".h5-cal-grid"),n.previous.bind("click",function(i){if(i.preventDefault(),e.support.transform3d){if(!(1<n.monthGrid.children().length)){n.currentMonth=n.currentMonth.addMonths(-1);var a=n.calendar.find("table"),o=t("<table>"+a.html()+"</table>");n.monthGrid.append(o),n.days=o.find("td a"),n.days.bind("click",t.proxy(n._dateSelected,n)),n.rows=o.find("tr"),n.rows.eq(1).addClass("first"),n._showMonth(n.currentMonth),o.addClass("myslideright ina"),a.addClass("myslideright outa").bind(e.support.animationEnd,function(){a.unbind(e.support.animationEnd),o.removeClass("myslideright ina"),a.remove()})}}else n.currentMonth=n.currentMonth.addMonths(-1),n._showMonth(n.currentMonth)}),n.next.bind("click",function(i){if(i.preventDefault(),e.support.transform3d){if(!(1<n.monthGrid.children().length)){n.currentMonth=n.currentMonth.addMonths(1);var a=n.calendar.find("table"),o=t("<table>"+a.html()+"</table>");n.monthGrid.append(o),n.days=o.find("td a"),n.days.bind("click",t.proxy(n._dateSelected,n)),n.rows=o.find("tr"),n.rows.eq(1).addClass("first"),n._showMonth(n.currentMonth),o.addClass("myslideleft ina"),a.addClass("myslideleft outa").bind(e.support.animationEnd,function(){a.removeClass("myslideleft outa").unbind(e.support.animationEnd),o.removeClass("myslideleft ina"),a.remove()})}}else n.currentMonth=n.currentMonth.addMonths(1),n._showMonth(n.currentMonth)}),n.calendar.bind("resetDates",function(){n.setDate("startDate",null),n.setDate("endDate",null)}),n._showMonth(n.currentMonth)},setDate:function(e,t){t&&t.clearTime&&t.clearTime(),"startDate"==e?this.startDate=t:this.endDate=t,this._drawSelection(),this.calendar.attr("data-"+e.toLowerCase(),t?t.toString():""),this.trigger(e+"Changed",{calendar:this,value:t})},selectDate:function(e){this.setDates(e.clone(),null),this.currentMonth=e,this._showMonth(e)},_dateSelected:function(e){if(e.preventDefault(),e=t(e.target),e.is("td a")&&!e.hasClass("inactive")&&0!=e.text().length){var n=new Date(this.currentMonth.getFullYear(),this.currentMonth.getMonth(),parseInt(e.text()));this.options.singleDate?(this.setDate("startDate",n),this.trigger("dateSelected",{calendar:this,value:n})):this.startDate?this.endDate?e.hasClass("startDate")?this.setDate("startDate",null):(e.hasClass("endDate")||this.setDate("startDate",null),this.setDate("endDate",null)):this.startDate<n?this.setDate("endDate",n):n<this.startDate?(this.setDate("endDate",this.startDate),this.setDate("startDate",n)):this.setDate("startDate",null):this.endDate?n<this.endDate?this.setDate("startDate",n):this.endDate<n?(this.setDate("startDate",this.endDate),this.setDate("endDate",n)):this.setDate("endDate",null):this.setDate("startDate",n)}},_getDay:function(e){return(e+this.options.firstDayOfWeek)%7},_drawSelection:function(){this.days.removeClass("startDate").removeClass("endDate").removeClass("betweenDates");var e=this.currentMonth.clone().moveToFirstDayOfMonth(),t=this.currentMonth.clone().moveToLastDayOfMonth(),n=this._getDay(e.getDay())-1;if(this.startDate&&this.endDate&&this.startDate<t&&this.endDate>e){var i=new Date(Math.max(e,this.startDate.clone().addDays(1))),a=new Date(Math.min(t,this.endDate.clone().addDays(-1)));a>=i&&this.days.slice(n+i.getDate(),n+a.getDate()+1).addClass("betweenDates")}this.startDate&&e<=this.startDate&&this.startDate<=t&&this.days.eq(n+this.startDate.getDate()).addClass("startDate"),this.endDate&&e<=this.endDate&&this.endDate<=t&&this.days.eq(n+this.endDate.getDate()).addClass("endDate")},setDates:function(e,t){this.options.singleDate&&(this.currentMonth=(e||today).clone(),this._showMonth(this.currentMonth)),this.setDate("startDate",e&&t?new Date(Math.min(e,t)):e),!this.options.singleDate&&this.setDate("endDate",e&&t?e.getTime()!=t.getTime()?new Date(Math.max(e,t)):null:t)},_showMonth:function(e){var t=this;t.minDate=new Date(Math.max(t.minDate,today)),t.dateInfo&&t.month.text(e.getFullYear()+"年"+t.dateInfo.months.names["long"][e.getMonth()]);var n=t.minDate>e.clone().moveToLastDayOfMonth(),i=!n&&t.minDate>=e.clone().moveToFirstDayOfMonth(),a=t.minDate.getDate();t.days.addClass("noTransition").removeClass("inactive"),t.rows.removeClass("last").removeClass("hidden");var o=t._getDay(e.clone().moveToFirstDayOfMonth().getDay())-1;e=o+e.clone().moveToLastDayOfMonth().getDate();for(var r=0,s=t.days.length;s>r;r++){var c=r>o&&e>=r,d=t.days.eq(r).text(c?""+(r-o):"");c&&(n||i&&a>r-o)&&d.addClass("inactive"),i&&today.getDate()==r-o&&d.addClass("today"),r==e&&d.closest("tr").addClass("last").next().addClass("hidden").next().addClass("hidden")}setTimeout(function(){t.days.removeClass("noTransition")},0),t._drawSelection()}});e.ui.plugin(i)}(),function(){Date.CultureInfo={name:"zh-cn",englishName:"简体中文",nativeName:"简体中文",dayNames:"星期天 星期一 星期二 星期三 星期四 星期五 星期六".split(" "),abbreviatedDayNames:"日一二三四五六".split(""),shortestDayNames:"Su Mo Tu We Th Fr Sa".split(" "),firstLetterDayNames:"SMTWTFS".split(""),monthNames:"January February March April May June July August September October November December".split(" "),abbreviatedMonthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",MDT:"-0700",PDT:"-0800"}},Date.getMonthNumberFromName=function(e){var t=Date.CultureInfo.monthNames,n=Date.CultureInfo.abbreviatedMonthNames;e=e.toLowerCase();for(var i=0;i<t.length;i++)if(t[i].toLowerCase()==e||n[i].toLowerCase()==e)return i;return-1},Date.getDayNumberFromName=function(e){var t=Date.CultureInfo.dayNames,n=Date.CultureInfo.abbreviatedDayNames;e=e.toLowerCase();for(var i=0;i<t.length;i++)if(t[i].toLowerCase()==e||n[i].toLowerCase()==e)return i;return-1},Date.isLeapYear=function(e){return 0===e%4&&0!==e%100||0===e%400},Date.getDaysInMonth=function(e,t){return[31,Date.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},Date.getTimezoneOffset=function(e,t){return t?Date.CultureInfo.abbreviatedTimeZoneDST[e.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[e.toUpperCase()]},Date.getTimezoneAbbreviation=function(e,t){var n,i=t?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard;for(n in i)if(i[n]===e)return n;return null},Date.prototype.clone=function(){return new Date(this.getTime())},Date.prototype.compareTo=function(e){if(isNaN(this))throw Error(this);if(e instanceof Date&&!isNaN(e))return this>e?1:e>this?-1:0;throw new TypeError(e)},Date.prototype.equals=function(e){return 0===this.compareTo(e)},Date.prototype.between=function(e,t){var n=this.getTime();return n>=e.getTime()&&n<=t.getTime()},Date.prototype.addMilliseconds=function(e){return this.setMilliseconds(this.getMilliseconds()+e),this},Date.prototype.addSeconds=function(e){return this.addMilliseconds(1e3*e)},Date.prototype.addMinutes=function(e){return this.addMilliseconds(6e4*e)},Date.prototype.addHours=function(e){return this.addMilliseconds(36e5*e)},Date.prototype.addDays=function(e){return this.addMilliseconds(864e5*e)},Date.prototype.addWeeks=function(e){return this.addMilliseconds(6048e5*e)},Date.prototype.addMonths=function(e){var t=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(t,this.getDaysInMonth())),this},Date.prototype.addYears=function(e){return this.addMonths(12*e)},Date.prototype.add=function(e){return"number"==typeof e?(this._orient=e,this):((e.millisecond||e.milliseconds)&&this.addMilliseconds(e.millisecond||e.milliseconds),(e.second||e.seconds)&&this.addSeconds(e.second||e.seconds),(e.minute||e.minutes)&&this.addMinutes(e.minute||e.minutes),(e.hour||e.hours)&&this.addHours(e.hour||e.hours),(e.month||e.months)&&this.addMonths(e.month||e.months),(e.year||e.years)&&this.addYears(e.year||e.years),(e.day||e.days)&&this.addDays(e.day||e.days),this)},Date._validate=function(e,t,n,i){if("number"!=typeof e)throw new TypeError(e+" is not a Number.");if(t>e||e>n)throw new RangeError(e+" is not a valid value for "+i+".");
return!0},Date.validateMillisecond=function(e){return Date._validate(e,0,999,"milliseconds")},Date.validateSecond=function(e){return Date._validate(e,0,59,"seconds")},Date.validateMinute=function(e){return Date._validate(e,0,59,"minutes")},Date.validateHour=function(e){return Date._validate(e,0,23,"hours")},Date.validateDay=function(e,t,n){return Date._validate(e,1,Date.getDaysInMonth(t,n),"days")},Date.validateMonth=function(e){return Date._validate(e,0,11,"months")},Date.validateYear=function(e){return Date._validate(e,1,9999,"seconds")},Date.prototype.set=function(e){return e.millisecond||0===e.millisecond||(e.millisecond=-1),e.second||0===e.second||(e.second=-1),e.minute||0===e.minute||(e.minute=-1),e.hour||0===e.hour||(e.hour=-1),e.day||0===e.day||(e.day=-1),e.month||0===e.month||(e.month=-1),e.year||0===e.year||(e.year=-1),-1!=e.millisecond&&Date.validateMillisecond(e.millisecond)&&this.addMilliseconds(e.millisecond-this.getMilliseconds()),-1!=e.second&&Date.validateSecond(e.second)&&this.addSeconds(e.second-this.getSeconds()),-1!=e.minute&&Date.validateMinute(e.minute)&&this.addMinutes(e.minute-this.getMinutes()),-1!=e.hour&&Date.validateHour(e.hour)&&this.addHours(e.hour-this.getHours()),-1!==e.month&&Date.validateMonth(e.month)&&this.addMonths(e.month-this.getMonth()),-1!=e.year&&Date.validateYear(e.year)&&this.addYears(e.year-this.getFullYear()),-1!=e.day&&Date.validateDay(e.day,this.getFullYear(),this.getMonth())&&this.addDays(e.day-this.getDate()),e.timezone&&this.setTimezone(e.timezone),e.timezoneOffset&&this.setTimezoneOffset(e.timezoneOffset),this},Date.prototype.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.isLeapYear=function(){var e=this.getFullYear();return 0===e%4&&0!==e%100||0===e%400},Date.prototype.isWeekday=function(){return!(this.is().sat()||this.is().sun())},Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())},Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1})},Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()})},Date.prototype.moveToDayOfWeek=function(e,t){var n=(e-this.getDay()+7*(t||1))%7;return this.addDays(0===n?n+7*(t||1):n)},Date.prototype.moveToMonth=function(e,t){var n=(e-this.getMonth()+12*(t||1))%12;return this.addMonths(0===n?n+12*(t||1):n)},Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/864e5)},Date.prototype.getWeekOfYear=function(e){var t=this.getFullYear(),n=this.getMonth(),i=this.getDate();e=e||Date.CultureInfo.firstDayOfWeek;var a=8-new Date(t,0,1).getDay();return 8==a&&(a=1),n=(Date.UTC(t,n,i,0,0,0)-Date.UTC(t,0,1,0,0,0))/864e5+1,n=Math.floor((n-a+7)/7),n===e&&(t--,t=8-new Date(t,0,1).getDay(),n=2==t||8==t?53:52),n},Date.prototype.isDST=function(){return console.log("isDST"),"D"==this.toString().match(/(E|C|M|P)(S|D)T/)[2]},Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST())},Date.prototype.setTimezoneOffset=function(e){var t=this.getTimezoneOffset();return this.addMinutes(-6*Number(e)/10-t),this},Date.prototype.setTimezone=function(e){return this.setTimezoneOffset(Date.getTimezoneOffset(e))},Date.prototype.getUTCOffset=function(){var e=-10*this.getTimezoneOffset()/6;return 0>e?(e=(e-1e4).toString(),e[0]+e.substr(2)):(e=(e+1e4).toString(),"+"+e.substr(1))},Date.prototype.getDayName=function(e){return e?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]},Date.prototype.getMonthName=function(e){return e?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]},Date.prototype._toString=Date.prototype.toString,Date.prototype.toString=function(e){var t=this,n=function(e){return 1==e.toString().length?"0"+e:e};return e?e.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(e){switch(e){case"hh":return n(13>t.getHours()?t.getHours():t.getHours()-12);case"h":return 13>t.getHours()?t.getHours():t.getHours()-12;case"HH":return n(t.getHours());case"H":return t.getHours();case"mm":return n(t.getMinutes());case"m":return t.getMinutes();case"ss":return n(t.getSeconds());case"s":return t.getSeconds();case"yyyy":return t.getFullYear();case"yy":return t.getFullYear().toString().substring(2,4);case"dddd":return t.getDayName();case"ddd":return t.getDayName(!0);case"dd":return n(t.getDate());case"d":return t.getDate().toString();case"MMMM":return t.getMonthName();case"MMM":return t.getMonthName(!0);case"MM":return n(t.getMonth()+1);case"M":return t.getMonth()+1;case"t":return 12>t.getHours()?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return 12>t.getHours()?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"zzz":case"zz":case"z":return""}}):this._toString()},Date.today=function(){return(new Date).clearTime()},Date.prototype._orient=1,Date.prototype.next=function(){return this._orient=1,this},Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){return this._orient=-1,this},Date.prototype._is=!1,Date.prototype.is=function(){return this._is=!0,this},Number.prototype._dateElement="day",Number.prototype.fromNow=function(){var e={};return e[this._dateElement]=this,(new Date).add(e)},Number.prototype.ago=function(){var e={};return e[this._dateElement]=-1*this,(new Date).add(e)},String.prototype.startWith=function(e){return RegExp("^"+e).test(this)},function(){for(var e=Date.prototype,t=Number.prototype,n="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),i="january february march april may june july august september october november december".split(/\s/),a="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),o=function(e){return function(){return this._is?(this._is=!1,this.getDay()==e):this.moveToDayOfWeek(e,this._orient)}},r=0;r<n.length;r++)e[n[r]]=e[n[r].substring(0,3)]=o(r);for(n=function(e){return function(){return this._is?(this._is=!1,this.getMonth()===e):this.moveToMonth(e,this._orient)}},o=0;o<i.length;o++)e[i[o]]=e[i[o].substring(0,3)]=n(o);for(n=function(e){return function(){return"s"!=e.substring(e.length-1)&&(e+="s"),this["add"+e](this._orient)}},o=function(e){return function(){return this._dateElement=e,this}},r=0;r<a.length;r++)i=a[r].toLowerCase(),e[i]=e[i+"s"]=n(a[r]),t[i]=t[i+"s"]=o(i)}(),Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ")},Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern)},Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern)},Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern)},Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern)},Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},function(){Date.Parsing={Exception:function(e){this.message="Parse error at '"+e.substring(0,10)+" ...'"}};for(var e=Date.Parsing,t=e.Operators={rtoken:function(t){return function(n){var i=n.match(t);if(i)return[i[0],n.substring(i[0].length)];throw new e.Exception(n)}},token:function(){return function(e){return t.rtoken(RegExp("^s*"+e+"s*"))(e)}},stoken:function(e){return t.rtoken(RegExp("^"+e))},until:function(e){return function(t){for(var n=[],i=null;t.length;){try{i=e.call(this,t)}catch(a){n.push(i[0]),t=i[1];continue}break}return[n,t]}},many:function(e){return function(t){for(var n=[],i=null;t.length;){try{i=e.call(this,t)}catch(a){break}n.push(i[0]),t=i[1]}return[n,t]}},optional:function(e){return function(t){var n=null;try{n=e.call(this,t)}catch(i){return[null,t]}return[n[0],n[1]]}},not:function(t){return function(n){try{t.call(this,n)}catch(i){return[null,n]}throw new e.Exception(n)}},ignore:function(e){return e?function(t){var n=null,n=e.call(this,t);return[null,n[1]]}:null},product:function(){for(var e=arguments[0],n=Array.prototype.slice.call(arguments,1),i=[],a=0;a<e.length;a++)i.push(t.each(e[a],n));return i},cache:function(t){var n={},i=null;return function(a){try{i=n[a]=n[a]||t.call(this,a)}catch(o){i=n[a]=o}if(i instanceof e.Exception)throw i;return i}},any:function(){var t=arguments;return function(n){for(var i=null,a=0;a<t.length;a++)if(null!=t[a]){try{i=t[a].call(this,n)}catch(o){i=null}if(i)return i}throw new e.Exception(n)}},each:function(){var t=arguments;return function(n){for(var i=[],a=null,o=0;o<t.length;o++)if(null!=t[o]){try{a=t[o].call(this,n)}catch(r){throw new e.Exception(n)}i.push(a[0]),n=a[1]}return[i,n]}},all:function(){var e=e;return e.each(e.optional(arguments))},sequence:function(n,i,a){return i=i||t.rtoken(/^\s*/),a=a||null,1==n.length?n[0]:function(t){for(var o=null,r=null,s=[],c=0;c<n.length;c++){try{o=n[c].call(this,t)}catch(d){break}s.push(o[0]);try{r=i.call(this,o[1])}catch(l){r=null;break}t=r[1]}if(!o)throw new e.Exception(t);if(r)throw new e.Exception(r[1]);if(a)try{o=a.call(this,o[1])}catch(u){throw new e.Exception(o[1])}return[s,o?o[1]:t]}},between:function(e,n,i){i=i||e;var a=t.each(t.ignore(e),n,t.ignore(i));return function(e){return e=a.call(this,e),[[e[0][0],r[0][2]],e[1]]}},list:function(e,n,i){return n=n||t.rtoken(/^\s*/),i=i||null,e instanceof Array?t.each(t.product(e.slice(0,-1),t.ignore(n)),e.slice(-1),t.ignore(i)):t.each(t.many(t.each(e,t.ignore(n))),px,t.ignore(i))},set:function(n,i,a){return i=i||t.rtoken(/^\s*/),a=a||null,function(o){for(var r=null,s=r=null,c=null,d=[[],o],l=!1,u=0;u<n.length;u++){r=s=null,l=1==n.length;try{r=n[u].call(this,o)}catch(h){continue}if(c=[[r[0]],r[1]],0<r[1].length&&!l)try{s=i.call(this,r[1])}catch(p){l=!0}else l=!0;if(l||0!==s[1].length||(l=!0),!l){for(r=[],l=0;l<n.length;l++)u!=l&&r.push(n[l]);r=t.set(r,i).call(this,s[1]),0<r[0].length&&(c[0]=c[0].concat(r[0]),c[1]=r[1])}if(c[1].length<d[1].length&&(d=c),0===d[1].length)break}if(0===d[0].length)return d;if(a){try{s=a.call(this,d[1])}catch(m){throw new e.Exception(d[1])}d[1]=s[1]}return d}},forward:function(e,t){return function(n){return e[t].call(this,n)}},replace:function(e,t){return function(n){return n=e.call(this,n),[t,n[1]]}},process:function(e,t){return function(n){return n=e.call(this,n),[t.call(this,n[0]),n[1]]}},min:function(t,n){return function(i){var a=n.call(this,i);if(a[0].length<t)throw new e.Exception(i);return a}}},n=function(e){return function(){var t=null,n=[];if(1<arguments.length?t=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(t=arguments[0]),!t)return e.apply(null,arguments);for(var i=t.shift();0<i.length;)return t.unshift(i[0]),n.push(e.apply(null,t)),t.shift(),n}},i="optional not ignore cache".split(/\s/),a=0;a<i.length;a++)t[i[a]]=n(t[i[a]]);for(n=function(e){return function(){return arguments[0]instanceof Array?e.apply(null,arguments[0]):e.apply(null,arguments)}},i="each any all".split(/\s/),a=0;a<i.length;a++)t[i[a]]=n(t[i[a]])}(),function(){var e=function(t){for(var n=[],i=0;i<t.length;i++)t[i]instanceof Array?n=n.concat(e(t[i])):t[i]&&n.push(t[i]);return n};Date.Grammar={},Date.Translator={hour:function(e){return function(){this.hour=Number(e)}},minute:function(e){return function(){this.minute=Number(e)}},second:function(e){return function(){this.second=Number(e)}},meridian:function(e){return function(){this.meridian=e.slice(0,1).toLowerCase()}},timezone:function(e){return function(){var t=e.replace(/[^\d\+\-]/g,"");t.length?this.timezoneOffset=Number(t):this.timezone=e.toLowerCase()}},day:function(e){var t=e[0];return function(){this.day=Number(t.match(/\d+/)[0])}},month:function(e){return function(){this.month=3==e.length?Date.getMonthNumberFromName(e):Number(e)-1}},year:function(e){return function(){var t=Number(e);this.year=2<e.length?t:t+(t+2e3<Date.CultureInfo.twoDigitYearMax?2e3:1900)}},rday:function(e){return function(){switch(e){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(e){e=e instanceof Array?e:[e];var t=new Date;for(this.year=t.getFullYear(),this.month=t.getMonth(),this.day=1,t=this.second=this.minute=this.hour=0;t<e.length;t++)e[t]&&e[t].call(this);if(this.hour="p"==this.meridian&&13>this.hour?this.hour+12:this.hour,this.day>Date.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");return e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second),this.timezone?e.set({timezone:this.timezone}):this.timezoneOffset&&e.set({timezoneOffset:this.timezoneOffset}),e},finish:function(t){if(t=t instanceof Array?e(t):[t],0===t.length)return null;for(var n=0;n<t.length;n++)"function"==typeof t[n]&&t[n].call(this);if(this.now)return new Date;if(t=Date.today(),null!=this.days||this.orient||this.operator){var i,a;return a="past"==this.orient||"subtract"==this.operator?-1:1,this.weekday&&(this.unit="day",n=Date.getDayNumberFromName(this.weekday)-t.getDay(),i=7,this.days=n?(n+a*i)%i:a*i),this.month&&(this.unit="month",n=this.month-t.getMonth(),i=12,this.months=n?(n+a*i)%i:a*i,this.month=null),this.unit||(this.unit="day"),(null==this[this.unit+"s"]||null!=this.operator)&&(this.value||(this.value=1),"week"==this.unit&&(this.unit="day",this.value*=7),this[this.unit+"s"]=this.value*a),t.add(this)}return this.meridian&&this.hour&&(this.hour=13>this.hour&&"p"==this.meridian?this.hour+12:this.hour),this.weekday&&!this.day&&(this.day=t.addDays(Date.getDayNumberFromName(this.weekday)-t.getDay()).getDate()),this.month&&!this.day&&(this.day=1),t.set(this)}};var t,n=Date.Parsing.Operators,i=Date.Grammar,a=Date.Translator;i.datePartDelimiter=n.rtoken(/^([\s\-\.\,\/\x27]+)/),i.timePartDelimiter=n.stoken(":"),i.whiteSpace=n.rtoken(/^\s*/),i.generalDelimiter=n.rtoken(/^(([\s\,]|at|on)+)/);var o={};i.ctoken=function(e){var t=o[e];if(!t){for(var t=Date.CultureInfo.regexPatterns,i=e.split(/\s+/),a=[],r=0;r<i.length;r++)a.push(n.replace(n.rtoken(t[i[r]]),i[r]));t=o[e]=n.any.apply(null,a)}return t},i.ctoken2=function(e){return n.rtoken(Date.CultureInfo.regexPatterns[e])},i.h=n.cache(n.process(n.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),a.hour)),i.hh=n.cache(n.process(n.rtoken(/^(0[0-9]|1[0-2])/),a.hour)),i.H=n.cache(n.process(n.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),a.hour)),i.HH=n.cache(n.process(n.rtoken(/^([0-1][0-9]|2[0-3])/),a.hour)),i.m=n.cache(n.process(n.rtoken(/^([0-5][0-9]|[0-9])/),a.minute)),i.mm=n.cache(n.process(n.rtoken(/^[0-5][0-9]/),a.minute)),i.s=n.cache(n.process(n.rtoken(/^([0-5][0-9]|[0-9])/),a.second)),i.ss=n.cache(n.process(n.rtoken(/^[0-5][0-9]/),a.second)),i.hms=n.cache(n.sequence([i.H,i.mm,i.ss],i.timePartDelimiter)),i.t=n.cache(n.process(i.ctoken2("shortMeridian"),a.meridian)),i.tt=n.cache(n.process(i.ctoken2("longMeridian"),a.meridian)),i.z=n.cache(n.process(n.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),a.timezone)),i.zz=n.cache(n.process(n.rtoken(/^(\+|\-)\s*\d\d\d\d/),a.timezone)),i.zzz=n.cache(n.process(i.ctoken2("timezone"),a.timezone)),i.timeSuffix=n.each(n.ignore(i.whiteSpace),n.set([i.tt,i.zzz])),i.time=n.each(n.optional(n.ignore(n.stoken("T"))),i.hms,i.timeSuffix),i.d=n.cache(n.process(n.each(n.rtoken(/^([0-2]\d|3[0-1]|\d)/),n.optional(i.ctoken2("ordinalSuffix"))),a.day)),i.dd=n.cache(n.process(n.each(n.rtoken(/^([0-2]\d|3[0-1])/),n.optional(i.ctoken2("ordinalSuffix"))),a.day)),i.ddd=i.dddd=n.cache(n.process(i.ctoken("sun mon tue wed thu fri sat"),function(e){return function(){this.weekday=e}})),i.M=n.cache(n.process(n.rtoken(/^(1[0-2]|0\d|\d)/),a.month)),i.MM=n.cache(n.process(n.rtoken(/^(1[0-2]|0\d)/),a.month)),i.MMM=i.MMMM=n.cache(n.process(i.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),a.month)),i.y=n.cache(n.process(n.rtoken(/^(\d\d?)/),a.year)),i.yy=n.cache(n.process(n.rtoken(/^(\d\d)/),a.year)),i.yyy=n.cache(n.process(n.rtoken(/^(\d\d?\d?\d?)/),a.year)),i.yyyy=n.cache(n.process(n.rtoken(/^(\d\d\d\d)/),a.year)),t=function(){return n.each(n.any.apply(null,arguments),n.not(i.ctoken2("timeContext")))},i.day=t(i.d,i.dd),i.month=t(i.M,i.MMM),i.year=t(i.yyyy,i.yy),i.orientation=n.process(i.ctoken("past future"),function(e){return function(){this.orient=e}}),i.operator=n.process(i.ctoken("add subtract"),function(e){return function(){this.operator=e}}),i.rday=n.process(i.ctoken("yesterday tomorrow today now"),a.rday),i.unit=n.process(i.ctoken("minute hour day week month year"),function(e){return function(){this.unit=e}}),i.value=n.process(n.rtoken(/^\d\d?(st|nd|rd|th)?/),function(e){return function(){this.value=e.replace(/\D/g,"")}}),i.expression=n.set([i.rday,i.operator,i.value,i.unit,i.orientation,i.ddd,i.MMM]),t=function(){return n.set(arguments,i.datePartDelimiter)},i.mdy=t(i.ddd,i.month,i.day,i.year),i.ymd=t(i.ddd,i.year,i.month,i.day),i.dmy=t(i.ddd,i.day,i.month,i.year),i.date=function(e){return(i[Date.CultureInfo.dateElementOrder]||i.mdy).call(this,e)},i.format=n.process(n.many(n.any(n.process(n.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(e){if(i[e])return i[e];throw Date.Parsing.Exception(e)}),n.process(n.rtoken(/^[^dMyhHmstz]+/),function(e){return n.ignore(n.stoken(e))}))),function(e){return n.process(n.each.apply(null,e),a.finishExact)});var r={};i.formats=function(e){if(e instanceof Array){for(var t=[],a=0;a<e.length;a++)t.push(r[e[a]]=r[e[a]]||i.format(e[a])[0]);return n.any.apply(null,t)}return r[e]=r[e]||i.format(e)[0]},i._formats=i.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]),i._start=n.process(n.set([i.date,i.time,i.expression],i.generalDelimiter,i.whiteSpace),a.finish),i.start=function(e){try{var t=i._formats.call({},e);if(0===t[1].length)return t}catch(n){}return i._start.call({},e)}}(),Date._parse=Date.parse,Date.parse=function(e){var t=null;if(!e)return null;try{t=Date.Grammar.start.call({},e)}catch(n){return null}return 0===t[1].length?t[0]:null},Date.getParseFunction=function(e){var t=Date.Grammar.formats(e);return function(e){var n=null;try{n=t.call({},e)}catch(i){return null}return 0===n[1].length?n[0]:null}},Date.parseExact=function(e,t){return Date.getParseFunction(t)(e)}}(),function(){function e(e,t,n){n||(n=function(){s.ui.hideWindow()}),c.showWindow(t,{title:null==e?"提示":e,width:280,height:48,modal:!0,closeCallback:n,actions:[{name:"确定",callback:n}]})}function t(e){return e===c.BOOKING_MODE_77?"77元预订":e===c.BOOKING_MODE_88?"88元预订":e===c.BOOKING_MODE_99?"99元预订":e===c.BOOKING_MODE_100?"100元预订":e===c.BOOKING_MODE_138?"138元预订":e===c.BOOKING_MODE_178?"178元预订":e===c.BOOKING_MODE_FREE_ROOM?"免费房预订":e===c.BOOKING_MODE_204?"128预订":e===c.BOOKING_MODE_202?"168预订":e===c.BOOKING_MODE_POINT||e===c.BOOKING_MODE_P2000||e===c.BOOKING_MODE_P5000||e===c.BOOKING_MODE_P7000||e===c.BOOKING_MODE_P10000?"积分兑换":e===c.BOOKING_MODE_WXCARD?"微信卡包优惠":e===c.BOOKING_MODE_TUAN77?"77团购预订":e===c.BOOKING_MODE_TUAN99?"去啊99特惠房":e===c.BOOKING_MODE_FREE?"免费房预订":e===c.BOOKING_MODE_777?"限时特惠房":e===c.BOOKING_MODE_94?"积分抵现房":e===c.BOOKING_MODE_XIAN206?"希岸许愿预订":null}function n(e){if(e||!r){var t=new Date;d.ajax({url:"/app/currentTime?"+Math.random(),dataType:"json",async:!1,success:function(e){t.setTime(e.time),r=t}}),r=t}return r.clone()}function i(e,t,n){null==n&&(n="id");for(var i=0,a=t.length;a>i;i++){var o=t[i];if(o[n]==e)return o}}function o(e,t){var n=e.getDay();return 1==t||2==t&&6==n?!1:0==n||n+t>6?!0:void 0}var r,s=window.hfive,c=window.webh5v2=window.webh5v2||{},d=s.$,l=d.proxy,u=s.support.mousedown,h=s.linkfocus,p=s.BaseView,m=d.trim,f=d.extend,g=d.get,w=s.localStorage,y=!1;c.hourSeparator=4,c.BOOKING_MODE_NORMAL="normal",c.BOOKING_MODE_POINT="point",c.BOOKING_MODE_77="77",c.BOOKING_MODE_88="88",c.BOOKING_MODE_99="99",c.BOOKING_MODE_FREE_ROOM="froom",c.BOOKING_MODE_P2000="P2000",c.BOOKING_MODE_P5000="P5000",c.BOOKING_MODE_P7000="P7000",c.BOOKING_MODE_P10000="P10000",c.BOOKING_MODE_138="138",c.BOOKING_MODE_178="178",c.BOOKING_MODE_202="168",c.BOOKING_MODE_204="128",c.BOOKING_MODE_100="100",c.BOOKING_MODE_777="777",c.BOOKING_MODE_94="94",c.BOOKING_MODE_XIAN206="xian206",c.BOOKING_MODE_WXCARD="97",c.BOOKING_MODE_TUAN77="tuan77",c.BOOKING_MODE_TUAN99="tuan99",c.BOOKING_MODE_FREE="free",c.MARKET_ID_77GIFT=1,c.MARKET_ID_88GIFT=76,c.MARKET_ID_99GIFT=78,c.MARKET_ID_FREE_ROOM=79,c.MARKET_ID_202GIFT=85,c.MARKET_ID_POINT_2000=5,c.MARKET_ID_POINT_5000=6,c.MARKET_ID_POINT_7000=12,c.MARKET_ID_POINT_10000=95,c.ROOM_TYPE_ZSD=220,c.ROOM_TYPE_ZST=221,c.SOURCE_TYPE_ID_DEFAULT=108,c.TREASURE_XIAN_SELLER_ID=258792,c.GIFT_INVALID=0,c.GIFT_UNUSED=1,c.GIFT_USED=2,c.GIFT_EXPIRED=3,c.GIFT_DEACTIVED=4,c.commentItemTemplate=s.template('<li><h4><b class="#= commentFlag#">&nbsp;</b><span>#=cardNo#&nbsp;&nbsp;#if(memberTypeName){# (#=memberTypeName#) #}#</span> #if(content == null || content == ""){# <span>#=createTime#</span> #}#</h4>#if(content && content != ""){#<span class="content"><b class="youdian">&nbsp;</b>#=content #</span>#}##if(disadvantage && disadvantage != ""){#<span class="content"><b class="qiedian">&nbsp;</b>#=disadvantage #</span>#}#<div class="reply">#if(replyContent){#<span class="header">#=replyBy# (#=replyTime#)</span><span class="content">#=replyContent#</span> #}# </div>#if(content != null && content != ""){# <span class="time">#=createTime#</span> #}#</li>'),c.phoneReg=/^[1]\d{10}$/,Date.CultureInfo.dayNames="周日 周一 周二 周三 周四 周五 周六".split(" "),d(document).bind("ajaxError",function(){});var v,D,M,b=p.extend({datePicker:null,init:function(e){p.fn.init.call(this,e),this.datePicker=d("#calDatePick").hfiveCalendar({dateSelected:l(this.onDateSelected,this)}).hfiveWidget(),this.homeView=e.homeView},initCom:function(){var e=d(".h5-calendar").height()+50;d("#calDatePick").css({height:e+"px"}),this.wrapper=d(".h5-datePickWrapper"),e=d("#"+this.view.data("header")),this.headerTitle=d(".h5-viewTitle",e)},showView:function(e){this.flag=0,app.trigger("onDatePickViewShow",{datePicker:this.datePicker,args:e})},historyGoBack:function(){this.app.goToView(this.homeView)},onDateSelected:function(e){this.app.trigger("onDateChanged",{date:e.value,args:e})}}),k=p.extend({itemTemplate:null,container:null,fldCount:null,data:null,allowDays:0,innId:null,arriveDate:null,departureDate:null,cityId:null,roomTypeId:null,init:function(e){p.fn.init.call(this,e),this.homeView=e.homeView},initCom:function(){this.itemTemplate=this.itemTemplate=s.template("<li class='h5-card-forward'><a href='javascript:;' data-refid='#= cashCouponsID#'><div class='left'><h4>返现券</h4><h3>￥#= amount#</h3></div><img style='max-height: 72px;width:12px;' src='/image/cashcoupons-bg.png'/><div class='right'><h4>有效期</h4><h3>#= new Date(usedBeginTime).toString('yyyy-MM-dd') #至#= new Date(usedEndTime).toString('yyyy-MM-dd') #</h3></div><b></b></a></li>"),this.container=d("#useCashCouponsView .cashcoupons-list"),this.fldCount=d("#useCashCouponsView span[data-name='count']"),d("#useCashCouponsView a[data-name='ok']").on("click",l(this.onOkClick,this)),h("#useCashCouponsView a")},doLoadView2:function(e,t){g("/html/useCashCouponsView.html",function(n){d("#viewLayout").append(n),e(t)})},historyGoBack:function(){this.onOkClick(null)},showView:function(e){this.app.trigger("onUseCashCouponsViewShow",{view:this,arg:e}),this.loadCashCoupons()},loadCashCoupons:function(){var e=this;e.container.empty(),o(Date.parse(e.arriveDate),e.allowDays)?d("div[data-name='weekendTip']",e.view).show():d("div[data-name='weekendTip']",e.view).hide(),s.ui.progress(e.container,!0);var t="/aq/enablecashcoupons?m="+Math.random(),t=t+("&innId="+e.innId),t=t+("&arriveDate="+e.arriveDate),t=t+("&departureDate="+e.departureDate),t=t+("&cityId="+e.cityId),t=t+("&roomTypeId="+e.roomTypeId);g(t,function(t){s.ui.progress(e.container,!1),e.data=t,t=s.render(e.itemTemplate,e.data);var n=d("<ul style='padding:0 10px;'></ul>");n.append(t),e.container.append(n),e.fldCount.text(e.allowDays),d("#useCashCouponsView .h5-frame").show(),d("#useCashCouponsView .h5-card-forward a").on("click",l(e.cashCouponClick,e))})},cashCouponClick:function(e){e&&e.preventDefault(),e=d(e.currentTarget),e.hasClass("sel")?e.removeClass("sel"):d("#useCashCouponsView .h5-card-forward a.sel").length>=this.allowDays?s.ui.showToast("您本次预订只能使用 "+this.allowDays+" 张返现券"):e.addClass("sel")},onOkClick:function(e){e&&e.preventDefault();var t=this,n=[];d("#useCashCouponsView .h5-card-forward a.sel").each(function(e,a){var o=d(a).data("refid"),o=i(o,t.data,"cashCouponsID");n.push(o)}),t.app.goToView(t.homeView),d("#useCashCouponsView .h5-frame").hide(),t.container.empty(),t.app.trigger("onCashCouponsSelected",{view:t,selected:n})}}),C=p.extend({itemTemplate:null,container:null,fldCount:null,data:null,allowDays:0,innId:null,arriveDate:null,departureDate:null,cityId:null,roomTypeId:null,init:function(e){p.fn.init.call(this,e),this.homeView=e.homeView},initCom:function(){this.itemTemplate=this.itemTemplate=s.template("<li class='h5-card-forward'><a href='javascript:;' data-refid='#= point#'><div class='left'><h4>抵现</h4><h3>￥#= money#</h3></div><img style='max-height: 72px;width:12px;' src='/image/cashcoupons-bg.png'/><div class='right'><h4>使用积分</h4><h3>#= point#</h3></div><b></b></a></li>"),this.container=d("#usePointsView .points-list"),this.fldCount=d("#usePointsView span[data-name='count']"),d("#usePointsView a[data-name='ok']").on("click",l(this.onOkClick,this)),h("#usePointsView a")},doLoadView2:function(e,t){g("/html/usePointsView.html",function(n){d("#viewLayout").append(n),e(t)})},historyGoBack:function(){this.onOkClick(null)},showView:function(e){this.app.trigger("onUsePointsViewShow",{view:this,arg:e}),this.loadPoints()},loadPoints:function(){var e=this;e.container.empty(),d("div[data-name='weekendTip']",e.view).hide(),s.ui.progress(e.container,!0);var t="/aq/enablepoints?m="+Math.random(),t=t+("&innId="+e.innId),t=t+("&arriveDate="+e.arriveDate),t=t+("&departureDate="+e.departureDate),t=t+("&cityId="+e.cityId),t=t+("&roomTypeId="+e.roomTypeId);g(t,function(t){s.ui.progress(e.container,!1),e.data=t,t=s.render(e.itemTemplate,e.data);var n=d("<ul style='padding:0 10px;'></ul>");n.append(t),e.container.append(n),e.fldCount.text(e.allowDays),d("#usePointsView .h5-frame").show(),d("#usePointsView .h5-card-forward a").on("click",l(e.pointClick,e))})},pointClick:function(e){e&&e.preventDefault(),e=d(e.currentTarget),e.hasClass("sel")?e.removeClass("sel"):0<d("#usePointsView .h5-card-forward a.sel").length?s.ui.showToast("您本次预订只能选择 一种抵现方式"):e.addClass("sel")},onOkClick:function(e){e&&e.preventDefault();var t=this,n=[];d("#usePointsView .h5-card-forward a.sel").each(function(e,a){var o=d(a).data("refid"),o=i(o,t.data,"point");n.push(o)}),t.app.goToView(t.homeView),d("#usePointsView .h5-frame").hide(),t.container.empty(),t.app.trigger("onPointsSelected",{view:t,selected:n})}}),O=p.extend({itemTemplate:null,container:null,fldCount:null,data:null,allowDays:0,innId:null,arriveDate:null,departureDate:null,cityId:null,roomTypeId:null,init:function(e){p.fn.init.call(this,e),this.homeView=e.homeView},initCom:function(){this.itemTemplate=this.itemTemplate=s.template("<li class='h5-card-forward'><a href='javascript:;' data-refid='#= currencyCouponsID#'><div class='left'><h4>抵用券</h4><h3>￥#= amount#</h3></div><img style='max-height: 72px;width:12px;' src='/image/vouchers-bg.png'/><div class='right'><h4>有效期</h4><h3>#= new Date(usedBeginTime).toString('yyyy-MM-dd') #至#= new Date(usedEndTime).toString('yyyy-MM-dd') #</h3></div><b></b></a></li>"),this.container=d("#useCurrencyCouponsView .currencycoupons-list"),this.fldCount=d("#useCurrencyCouponsView span[data-name='count']"),d("#useCurrencyCouponsView a[data-name='ok']").on("click",l(this.onOkClick,this)),h("#useCurrencyCouponsView a")},doLoadView2:function(e,t){g("/html/useCurrencyCouponsView.html",function(n){d("#viewLayout").append(n),e(t)})},historyGoBack:function(){this.onOkClick(null)},showView:function(e){this.app.trigger("onUseCurrencyCouponsViewShow",{view:this,arg:e}),this.loadCashCoupons()},loadCashCoupons:function(){var e=this;e.container.empty(),o(Date.parse(e.arriveDate),e.allowDays)?d("div[data-name='weekendTip']",e.view).show():d("div[data-name='weekendTip']",e.view).hide(),s.ui.progress(e.container,!0);var t="/aq/enablecurrencycoupons?m="+ +Math.random(),t=t+("&innId="+e.innId),t=t+("&arriveDate="+e.arriveDate),t=t+("&departureDate="+e.departureDate),t=t+("&cityId="+e.cityId),t=t+("&roomTypeId="+e.roomTypeId);g(t,function(t){s.ui.progress(e.container,!1),e.data=t,t=s.render(e.itemTemplate,e.data);var n=d("<ul style='padding:0 10px;'></ul>");n.append(t),e.container.append(n),e.fldCount.text(e.allowDays),d("#useCurrencyCouponsView .h5-frame").show(),d("#useCurrencyCouponsView .h5-card-forward a").on("click",l(e.cashCouponClick,e))})},cashCouponClick:function(e){e.preventDefault(),e=d(e.currentTarget),e.hasClass("sel")?e.removeClass("sel"):d("#useCurrencyCouponsView .h5-card-forward a.sel").length>=this.allowDays?s.ui.showToast("您本次预订只能使用 "+this.allowDays+" 张抵用券"):e.addClass("sel")},onOkClick:function(e){e&&e.preventDefault();var t=this,n=[];d("#useCurrencyCouponsView .h5-card-forward a.sel").each(function(e,a){var o=d(a).data("refid"),o=i(o,t.data,"currencyCouponsID");n.push(o)}),t.app.goToView(t.homeView),d("#useCurrencyCouponsView .h5-frame").hide(),t.container.empty(),t.app.trigger("onCurrencyCouponsSelected",{view:t,selected:n})}}),_=p.extend({showRegister:!1,verificationCode:!1,sendCode:!1,hideWeixinOption:!1,init:function(e){p.fn.init.call(this,e),e.showRegister&&(this.showRegister=!0),this.homeView=e.homeView},doLoadView2:function(e,t){d.ajax({type:"GET",url:"/login.html",cache:!1,success:function(n){d("#viewLayout").append(n),e(t)}})},initCom:function(){var e=this;0<=e.view.length&&(e.view=d("#login2View")),d("#sel-dynamic",e.view).on("click",l(e.onCutOverModelClick,e)),d("#sel-service",e.view).on("click",l(e.onCutOverModelClick,e)),d("a[data-name='get-password']").on("click",l(e.onGetPasswordClick,e)),d("a[data-name='registry']").on("click",l(e.onGoRegistryClick,e)),e.supportckc=d("[data-name='supportckc']",e.view).val(),d("#login2View .h5-checkbox-selectable").on("click",l(e.autoLoginClick,e)),d("input[type=text],input[type=password]").on("input",function(){if(0==d(this).val().length)d(this).parent().find(".input-close").remove();else if(!(0<d(this).parent().find(".input-close").length)){var e=30;$parent=d(this).parent(),"lgcheckcodewrap"==$parent.attr("data-name")||"dpcheckcodewrap"==$parent.attr("data-name")?e=232:0<$parent.find("#countdown").length&&0==$parent.find(".h5-button-style1").attr("style").length&&(e=120),d(this).parent().append("<img class='input-close' style='position:absolute;width:20px; right:"+e+"px;top:50%;margin-top:-10px;' src='../image/input-close.png' />"),d(".input-close").on("click",function(){d(this).parent().find("input[type=text],input[type=password]").val(""),d(this).remove()})}}),d("input[type=text],input[type=password]").on("blur",function(){d(this).parent().find(".input-close").css("opacity","0")}),d("input[type=text],input[type=password]").on("focus",function(){d(this).parent().find(".input-close").css("opacity","1")}),e.hideWeixinOption&&c.hideWeixinOptionMenu(),e.showRegister&&d("a[data-name='registry']",e.view).css("display","inline-block"),d("a[data-name='login']",e.view).on("click",l(e.onLoginClick,e)),d('a[data-name="refreshCheckcode"]',e.view).on("click",function(){d("img[data-name='imgCheckcode']",e.view).attr("src","/imageToken?id=dpCheckcode&r="+Math.random())}),d('a[data-name="refreshlCheckcode"]',e.view).on("click",function(){d("img[data-name='imglCheckcode']",e.view).attr("src","/imageToken?id=lgCheckcode&r="+Math.random())}),v=d("#login2View input[data-name='phone']"),D=d("#login2View input[data-name='password']"),M=d("#login2View span[data-name='memberLabel']"),h("#login2View a")},showView:function(e){d("#countdown").next().css("right","120px"),d("span#passwordType").text("动态密码"),D.attr("placeholder","动态密码5分钟内有效"),M.text("手机号码"),v.attr("placeholder",""),d("a[data-name='get-password']").show(),d("#tc_vcode_img2").is("img")&&(TSOCapObj.init("tc_vcode_img2"),TSOCapObj.refresh()),d("#login2View .h5-input").removeClass("h5-error"),app.trigger("onLogin2ViewShow",{args:e}),this.verificationCode=!1
},historyGoBack:function(){this.app.goToView(this.homeView)},onCutOverModelClick:function(e){e.preventDefault(),e=d(e.currentTarget),e.find(".icons").hasClass("selected")||(d(".h5-login-swith .icons.selected").removeClass("selected"),e.find(".icons").addClass("selected"),"sel-dynamic"==e.attr("id")?(d("#countdown").next().css("right","120px"),d("span#passwordType").text("动态密码"),D.attr("placeholder","动态密码5分钟内有效"),M.text("手机号码"),v.attr("placeholder",""),d("a[data-name='get-password']").show(),d("div[data-name='dpcheckcodewrap']",this.view).show(),d("div[data-name='lgcheckcodewrap']",this.view).hide(),d("img[data-name='imgCheckcode']",this.view).attr("src","/imageToken?id=dpCheckcode&r="+Math.random()),d("#tc_vcode_img2").is("img")&&(TSOCapObj.init("tc_vcode_img2"),TSOCapObj.refresh())):(d("#countdown").next().css("right","30px"),d("span#passwordType").text("会员密码"),D.attr("placeholder",""),M.text("7天会员"),v.attr("placeholder","7天会员号/注册手机或证件号"),d("a[data-name='get-password']").hide(),d("div[data-name='lgcheckcodewrap']",this.view).show(),d("div[data-name='dpcheckcodewrap']",this.view).hide(),d("img[data-name='imgCheckcode']",this.view).attr("src","/imageToken?id=lgCheckcode&r="+Math.random()),d("#tc_vcode_img").is("img")&&(TSOCapObj.init("tc_vcode_img"),TSOCapObj.refresh())))},onLoginClick:function(t){t.preventDefault();var n=this;d("#login2View .h5-input").removeClass("h5-error");var i=v.val(),a=D.val(),o=d(".h5-login-swith .icons.selected").data("ref"),r=d("input[name='ratk']",n.view).val(),l=d("input[data-name='lCheckCode']",n.view).val();if(0>=m(i).length)v.addClass("h5-error"),s.ui.showToast(0===o?"请输入会员号":"请输入手机号码");else{o=1;try{InsightMethodInvoke("trkLoginBtn",i)}catch(u){}if(1!==o||n.sendCode){if(0>=m(a).length)D.addClass("h5-error"),s.ui.showToast("请输入密码");else if(1!==o||n.checkPhone(i))if(0===o&&"true"==n.supportckc&&0>=m(l))s.ui.showToast("请输入验证码");else{var h=s.cookie("WX_OPENID");"null"==h&&(h=null);var p=s.cookie("YX_OPENID");"null"==p&&(p=null),0===o&&d("#tc_vcode_img").is("img")?0>=m(l)?s.ui.showToast("请输入验证码"):TSOCapObj.verify(l,function(t){0!=t.errorCode?(c.showMessageWindow(null,"<span>验证码错误</span>"),TSOCapObj.refresh()):(l=t.ticket,s.ui.showTips("正在登录...."),d.ajax({type:"POST",url:"/ajax_authentication?"+Math.random(),data:{username:i,password:a,atk:r,lgCheckcode:d.trim(l+" "),openid:h,yxopenid:p,j_expiredays:d("#login2View .h5-checkbox-selectable").hasClass("h5-checked")?7:0,passwordType:o},success:function(t){if(s.ui.hideTips(),"success"==t.result){try{InsightMethodInvoke("trkLoginError",i)}catch(a){}var r=d("#login2View .h5-checkbox-selectable").hasClass("h5-checked"),l=null;-1<location.hostname.indexOf("plateno")?l=".plateno.com":-1<location.hostname.indexOf("7daysinn")&&(l=".7daysinn.cn"),Date.prototype.DateFormat||(Date.prototype.DateFormat=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e}),s.cookie("loginStatus",(new Date).DateFormat("yyyy-MM-dd hh:mm:ss")+"|"+r,{path:"/",domain:l});var u=t.redirectUrl;t.msg?e("","<span>"+t.msg+"</span>",function(){s.ui.hideWindow(),n.loginSuccess(u)}):n.loginSuccess(u),n.sendCode=!1}else{d("#tc_vcode_img").is("img")||d("#tc_vcode_img2").is("img")?TSOCapObj.refresh():n.supportckc&&d("img[data-name='imglCheckcode']",n.view).attr("src","/imageToken?id=lgCheckcode&r="+Math.random()),r=null,r=t.message?t.message:0===o?"您输入的用户名或密码有误，请重新输入！":"您输入动态密码有误，请重新输入",c.showMessageWindow(null,"<span>"+r+"</span>");try{InsightMethodInvoke("trkLoginError",i,r)}catch(h){}v.focus()}},dataType:"json"}))}):(s.ui.showTips("正在登录...."),d.ajax({type:"POST",url:"/ajax_authentication?"+Math.random(),data:{username:i,password:a,atk:r,lgCheckcode:d.trim(l+" "),openid:h,yxopenid:p,j_expiredays:d("#login2View .h5-checkbox-selectable").hasClass("h5-checked")?7:0,passwordType:o},success:function(t){if(s.ui.hideTips(),"success"==t.result){try{InsightMethodInvoke("trkLoginError",i)}catch(a){}var r=d("#login2View .h5-checkbox-selectable").hasClass("h5-checked"),l=null;-1<location.hostname.indexOf("plateno")?l=".plateno.com":-1<location.hostname.indexOf("7daysinn")&&(l=".7daysinn.cn"),Date.prototype.DateFormat||(Date.prototype.DateFormat=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e}),s.cookie("loginStatus",(new Date).DateFormat("yyyy-MM-dd hh:mm:ss")+"|"+r,{path:"/",domain:l});var u=t.redirectUrl;t.msg?e("","<span>"+t.msg+"</span>",function(){s.ui.hideWindow(),n.loginSuccess(u)}):n.loginSuccess(u),n.sendCode=!1}else{n.supportckc&&d("img[data-name='imglCheckcode']",n.view).attr("src","/imageToken?id=lgCheckcode&r="+Math.random()),r=null,r=t.message?t.message:0===o?"您输入的用户名或密码有误，请重新输入！":"您输入动态密码有误，请重新输入",c.showMessageWindow(null,"<span>"+r+"</span>");try{InsightMethodInvoke("trkLoginError",i,r)}catch(h){}v.focus()}},dataType:"json"}))}}else n.errorFlag?s.ui.showToast("您输入的动态密码有误，请重新输入！"):(s.ui.showToast("您还没有获取动态密码，请先获取动态密码"),n.errorFlag=!0)}},onGetPasswordClick:function(){var e=this,t=v.val();if(!e.verificationCode&&(d("#login2View .h5-input").removeClass("h5-error"),e.checkPhone(t))){var n=d("input[data-name='dpCheckCode']",e.view).val();if(0>=m(n).length)s.ui.showToast("请输入验证码");else{try{InsightMethodInvoke("trkLoginSMS",t)}catch(i){}d("#tc_vcode_img2").is("img")?TSOCapObj.verify(n,function(i){0!=i.errorCode?(c.showMessageWindow(null,"<span>验证码错误</span>"),TSOCapObj.refresh()):(n=i.ticket,s.ui.showTips("正在申请动态密码..."),d.ajax({type:"POST",url:"/s/sendverificationcodebyqcloud?checkcode="+n+"&mobile="+t+"&a="+Math.random(),success:function(t){s.ui.hideTips(),"success"==t.result?(e.sendCode=!0,e.verificationCode=!0,c.showWindow("<span>动态密码已发送到您的手机上，注意查收</span>",{title:"成功",width:280,height:48,modal:!0,closeCallback:e.countDown,actions:[{name:"确定",callback:function(){s.ui.hideWindow(),e.countDown()}}]})):c.showMessageWindow("失败","<span>"+t.message+"</span>")},dataType:"json"}))}):(s.ui.showTips("正在申请动态密码..."),d.ajax({type:"POST",url:"/s/sendverificationcode?checkcode="+n+"&mobile="+t+"&a="+Math.random(),success:function(t){s.ui.hideTips(),"success"==t.result?(e.sendCode=!0,e.verificationCode=!0,c.showWindow("<span>动态密码已发送到您的手机上，注意查收</span>",{title:"成功",width:280,height:48,modal:!0,closeCallback:e.countDown,actions:[{name:"确定",callback:function(){s.ui.hideWindow(),e.countDown()}}]})):c.showMessageWindow("失败","<span>"+t.message+"</span>")},dataType:"json"}))}}},countDown:function(){var e=this;d("a[data-name='get-password']",e.veiw).hide(),d("span#countdown",e.view).show();var t=60,n=setInterval(function(){t>0?(t--,d("span[data-name='time-show']",e.view).text(t)):(clearInterval(n),e.verificationCode=!1,d("span[data-name='time-show']",e.view).text("60"),d("span#countdown",e.view).hide(),d("a[data-name='get-password']",e.view).show())},1e3)},checkPhone:function(e){return 0>=m(e).length?(v.addClass("h5-error"),s.ui.showToast("请输入手机号码"),!1):c.phoneReg.test(e)?!0:(v.addClass("h5-error"),s.ui.showToast("您输入的手机号码有误，请重新输入！"),!1)},autoLoginClick:function(e){d(e.currentTarget).toggleClass("h5-checked")},loginSuccess:function(e){var t=s.getHashes();e?window.location=e:t&&(t.redirectUrl||t.redirect)?(e=t.redirectUrl?t.redirectUrl:t.redirect?t.redirect:"","gift77"==t.redirectUrl?(this.app.one("onRetrieveMemberInfo",this.gift77Redirect),c.getMemberInfo(!0)):(t=decodeURIComponent(e),window.location.href=t)):(c.islogin=!0,app.trigger("onLoginSuccess",{}),c.getMemberInfo(!0),this.app.goToView(this.homeView))},gift77Redirect:function(e){(e=e[0].memberInfo)&&0<e.memberId&&(e.gift77.canApply?window.location="/activities/index#view=gift77":e.gift77.gift?window.location=e.gift77.gift.flag==c.GIFT_UNUSED?"/index#view=home&mode=77":e.gift77.gift.flag==c.GIFT_DEACTIVED?"/activities/index#view=gift77":"/index#view=home":e.validMobile||(window.location="/activities/index#view=gift77"))},doBindWeixin:function(t,n,i){t&&0<t.memberId&&t.weixinBinded?i&&i.call():d.ajax({type:"POST",url:"/p/weixin/bindCurrentUser",data:{openid:n},success:function(t){"success"==t.result?e("","<span>您的微信号已经绑定到您的7天账户。</span>",bindFinishedCall):s.ui.showWindow("<span>7天会员微信号绑定失败。您是否未关注“7天会”微信？</span>",{title:"提示",width:280,height:80,modal:!0,actions:[{name:"确定",callback:function(){s.ui.hideWindow(),i&&i.call()}}]})},dataType:"json"})},onGoRegistryClick:function(e){e=s.getHashes(),window.location=e&&(e.redirectUrl||e.redirect)?"/register/index#view=register&redirect="+(e.redirectUrl?e.redirectUrl:e.redirect?e.redirect:"")+(e.jump?"&jump=true":"")+(e.sellerId?"&sellerId="+e.sellerId:""):"/register/index#view=register"}}),T=p.extend({innId:null,canShow:!1,init:function(e){p.fn.init.call(this,e),this.homeView=e.homeView},doLoadView2:function(e,t){g("/html/innComment.html",function(n){d("#viewLayout").append(n),e(t)})},initCom:function(){var e=this;d("a[data-name='loadMore']",e.view).on("click",l(e.loadMoreCommentsData,e)),d("#innCommentView a[data-name='return']").on("click",function(){e.app.goToView(e.homeView)}),d("#innCommentView div.get-more").hide(),h("#innCommentView a")},showView:function(e){var t=this;t.data=[],app.trigger("onInnCommentViewShow",{view:t,args:e}),d("#innCommentView #all-comment-container").empty(),d("#innCommentView div.get-more").hide(),setTimeout(function(){t.loadMoreCommentsData()},100)},unloadView:function(e){d("#innCommentView div.get-more").hide(),d("#innCommentView #all-comment-container").empty(),app.trigger("onInnCommentViewUnload",{view:this,args:e})},checkView:function(){var e=this;return e.canShow?!0:function(){e.app.goToView(e.homeView)}},historyGoBack:function(){this.app.goToView(this.homeView)},loadMoreCommentsData:function(){var e=this,t=1,n=s.getHashes();if(n&&n.innId){var i=d("#innCommentView #all-comment-container");0<e.data.length&&(t=e.data[e.data.length-1].number+1),s.ui.progress(d("#innCommentView .view-progress"),!0),d.getJSON("/q/inn/comments/"+n.innId+"?page="+t+" &size=10",function(t){if(s.ui.hideTips(),e.data.push(t),0==t.totalElements)i.text("此分店还没有评论哦。"),d("#innCommentView div.get-more").hide();else{var n=s.render(c.commentItemTemplate,t.content),a=d(".h5-list",i);a.length?a.append(n):(a=d("<ul class='h5-list'></ul>"),a.append(n),i.append(a)),d("#innCommentView .view-progress").empty(),t.lastPage?d("#innCommentView div.get-more").hide():d("#innCommentView div.get-more").show()}})}}}),I=p.extend({doLoadView2:function(e,t){g("/html/appErrorView.html",function(n){d("#viewLayout").append(n),e(t)})},initCom:function(){d("#appErrorView a[data-name='return-home']").bind("click",l(this.onGoToHomeViewClick,this)),h("#appErrorView a")},onGoToHomeViewClick:function(){window.location="/index#view=home"}});f(c,{islogin:!1,datePickView:b,hideWeixinOptionMenu:function(){var e=function(){WeixinJSBridge.invoke("hideOptionMenu",{},function(e){callback(e)})};"undefined"==typeof WeixinJSBridge?document.addEventListener("WeixinJSBridgeReady",e,!1):e()},login2View:_,useCashCouponsView:k,usePointsView:C,useCurrencyCouponsView:O,innCommentView:T,appErrorView:I,showMessageWindow:e,toggleItemActiveClass:function(e){d(e.currentTarget).toggleClass("h5-state-active",e.type===u)},getCurrentTime:n,filterObject:i,getMemberInfo:function(e,t,n){e||!y?(y=!0,d.getJSON("/q/memberinfo?"+Math.random(),function(e){c.memberInfo=e,c.islogin=!1,0<c.memberInfo.memberId&&(c.islogin=!0),c.app&&c.app.trigger("onRetrieveMemberInfo",{memberInfo:c.memberInfo,islogin:c.islogin}),d.isFunction(t)&&(n?t.call(n,e):t(e)),0<c.memberInfo.memberId&&(e=null,-1<location.hostname.indexOf("plateno")?e=".plateno.com":-1<location.hostname.indexOf("7daysinn")&&(e=".7daysinn.cn"),s.cookie("user",c.memberInfo.memberId+"|"+c.memberInfo.memberType,{expires:365,path:"/",domain:e}))})):(c.app&&null!=c.memberInfo&&c.app.trigger("onRetrieveMemberInfo",{memberInfo:c.memberInfo,islogin:c.islogin}),d.isFunction(t)&&(n?t.call(n,c.memberInfo):t(c.memberInfo)))},getSearchBottonTitle:function(e){return""===m(e)||e===c.BOOKING_MODE_NORMAL?"搜索":t(e)},isMarketActivityBooking:function(e){return e==c.BOOKING_MODE_77||e==c.BOOKING_MODE_88||e==c.BOOKING_MODE_99||e==c.BOOKING_MODE_FREE_ROOM||e==c.BOOKING_MODE_POINT||e==c.BOOKING_MODE_138||e==c.BOOKING_MODE_100||e==c.BOOKING_MODE_94||e==c.BOOKING_MODE_178||e==c.BOOKING_MODE_202||e==c.BOOKING_MODE_204||e==c.BOOKING_MODE_P2000||e==c.BOOKING_MODE_P5000||e==c.BOOKING_MODE_P7000||e==c.BOOKING_MODE_P10000||e==c.BOOKING_MODE_TUAN77||e==c.BOOKING_MODE_TUAN99||e==c.BOOKING_MODE_FREE||e==c.BOOKING_MODE_777},getMarketActivityName:t,isNull:function(e){var t=!0;return e&&(e=d.trim(e),0<e.length&&(t=!1)),t},substr:function(e,t){var n=0,i=0;str_cut="";for(var i=e.length,o=0;i>o;o++)if(a=e.charAt(o),n++,4<escape(a).length&&n++,str_cut=str_cut.concat(a),n>=t)return str_cut=str_cut.concat("...");return t>n?e:void 0},checkBooingDate:function(e){var t=c.getCurrentTime(!0);t.getHours()<c.hourSeparator&&t.addDays(-1);var t=t.clearTime(),n=new Date(t.getTime());n.addDays(90);var i=Date.parse(e.arriveDate);return e=Date.parse(e.departureDate),i>=e||t>i||e>=n?(s.ui.showToast("订房时间超出了范围。"),!1):!0},scrollTop:function(){setTimeout(function(){document.body.scrollTop=0},100)},setBookParam:function(e){this.bookParam=e,w.setItem("h5app","webh5v2_book_param",JSON.stringify(e))},getBookParam:function(){return null==this.bookParam&&(this.bookParam=s.parseJson(w.getItem("h5app","webh5v2_book_param"))),this.bookParam},setLastRoomCount:function(e){w.setItem("h5app","webh5v2_book_roomCount",e)},getLastRoomCount:function(){return w.getItem("h5app","webh5v2_book_roomCount")},initiaizeViewParamWithHash:function(e){var t=this.getBookParam(),i=s.getHashes();if(null==t||"innDtl"===e&&null==t.innInfo||t.innInfo&&i&&i.innId&&t.innInfo.innId!=i.innId||i&&i.cityId&&t.cityId!=i.cityId||i&&i.longitude&&i.latitude||i&&i.suggestInns||i&&i.brands||i&&i.fromDate&&i.fromDate!=t.arriveDate||i&&i.toDate&&i.toDate!=t.departureDate){console.log("Create"),t={},t.bookingMode=c.BOOKING_MODE_NORMAL,i&&i.innId&&(t.innInfo={innId:i.innId}),i&&i.cityId&&(t.cityId=i.cityId,t.districtId=0),i&&i.filterBySaleActivity&&(t.filterBySaleActivity=!0),i&&i.longitude&&(t.longitude=i.longitude,t.latitude=i.latitude,t.cityId=0,t.loc=!0),i&&i.suggestInns&&(t.cityId=0,t.suggestInns=!0),i&&i.brands&&(t.brands=i.brands),e=n(!0),e.getHours()<c.hourSeparator&&e.addDays(-1),e=e.clearTime();var a=null,o=null;i&&i.fromDate&&(a=Date.parse(i.fromDate,"yyyy-MM-dd")),(null==a||e>a)&&(a=e),i&&i.toDate&&(o=Date.parse(i.toDate,"yyyy-MM-dd")),(null==o||a>=o)&&(o=a.clone().addDays(1)),t.arriveDate=a.toString("yyyy-MM-dd"),t.departureDate=o.toString("yyyy-MM-dd"),t.days=(o-a)/864e5,t.nohandleback=!0,t.fromgift=i.fromgift,this.setBookParam(t)}else e=n(!0),e.getHours()<c.hourSeparator&&e.addDays(-1),e=e.clearTime(),a=Date.parse(t.arriveDate,"yyyy-MM-dd"),e>a&&(a=e,o=a.clone().addDays(1),t.arriveDate=a.toString("yyyy-MM-dd"),t.departureDate=o.toString("yyyy-MM-dd"),t.days=1);return i&&i.sellerId&&(t.sellerId=i.sellerId),t},showWindow:function(e,t){var n=d("div.h5-window"),i=t.closeCallback;0==n.length&&(n=d("<div class='h5-window' style='position:absolute;'><div class='h5-window-title'><span class='title'></span><a href='javascript:;' class='close'><span class='icon icon-close close'></span></a></div><div class='h5-window-content'></div><div class='h5-window-bottom'><div class='h5-window-buttons'></div></div></div>").appendTo(d("body")),d("a.close",n).bind("click",function(){c.hideWindow(),d.isFunction(i)&&i()}));var a=d(window).scrollTop(),o=t&&t.width?t.width:320,r=t&&t.height?t.height:80,l=o+14,u=r+(t&&t.actions?80:40),a=a+(d(window).height()-u)/2,h=0+(d(window).width()-l)/2;d("div.h5-window-content",n).css({width:o+"px",height:r+"px"}),t&&t.title&&d("span.title",n).text(t.title),d("div.h5-window-content",n).html(d(e)),d("div.h5-window-buttons",n).empty(),t&&t.actions&&d.each(t.actions,function(){var e=d("<a href='javascript:;' class='h5-button' style='margin-right:.5em;font-size:.8em;"+(this.style?this.style:"")+"'>"+this.name+"</a>");e.bind("click",this.callback),d("div.h5-window-buttons",n).append(e)}),t.modal&&s.ui._overlay(!0,n),n.css({width:l+"px",height:u+"px",top:a+"px",left:h+"px"}).show()},hideWindow:function(){s.ui._overlay(!1,d("div.h5-window")),d("div.h5-window").hide()},formatDate:function(e){var t=new Date;return t.setTime(e),t.toString("yyyy-MM-dd")},goDownloadApp:function(){d.os.android||d.os.kindle?window.location="/app/download?type=android":d.os.ipad||d.os.iphone?window.location="/app/download?type=ios":c.showWindow("<span>请选择你要下载的客户端类型。</span>",{title:"下载",width:280,height:48,modal:!0,actions:[{name:"Android客户端",callback:function(){c.hideWindow(),window.location="/app/download?type=android"}},{name:"IOS客户端",callback:function(){c.hideWindow(),window.location="/app/download?type=ios"}}]})},checkPassword:function(e){if(18<e.length)return 0;var t=0;return e.match(/[a-zA-Z]/gi)&&t++,e.match(/[0-9]/gi)&&t++,e.match(/(.[^A-Za-z0-9])/gi)&&t++,6>e.length&&t>0&&t--,t}})}();
define("game-sign/index/index",function(require,exports,module){function init(){addEvent(),new Tabs({nav:".tab-nav > li",content:".tab-container > .item-container"})}function addEvent(){$(".signin-btn").on("click",sign),$("#prizestar").on("click",start),$("#J-wake-sign").on("click",subRemind)}function subRemind(){var t=$(this),n=0;t.hasClass("waked")&&(n=1),(new Ajax).send({url:"/Game/LotteryDraw/setLotteryDrawRemind",data:{state:n}},function(){0==n?t.addClass("waked"):t.removeClass("waked")})}function sign(){var t=$(this);t.hasClass("disabled")||(new Ajax).send({url:" /Game/LotteryDraw/sign",selfLoginSuc:function(){location.reload()}},function(n){t.addClass("disabled").text("已签到"),$("#J-sign-days").text(n.loginDays),$("#J-award-amount").text(n.logteryDrawTimes),$("#J-scroe-num").text(n.score),5==n.loginDays?$(".dy5").addClass("active2"):1==n.loginDays?($(".days-box > span").removeClass("active"),$(".days-box > .dy5").removeClass("active2"),$(".days-box > .dy1").addClass("active")):$(".dy"+n.loginDays).addClass("active")})}function start(){return+$("#J-award-amount").text()<=0?(Bubble.show("抽奖次数不足"),!1):awarding?!1:(awarding=!0,void(new Ajax).send({url:" /Game/LotteryDraw/startLucky",selfLoginSuc:function(){location.reload()}},function(t){rotateFunc(prizeDeg[t.winNumber],t)},function(){awarding=!1}))}function rotateFunc(angle,result){var Deg=3600;angle+=Deg,$("#rotatebg").stopRotate(),$("#rotatebg").rotate({angle:0,duration:5e3,animateTo:angle,callback:function(){var type=result.type,$amount=$("#J-award-amount"),num=+$amount.text();if(awarding=!1,--num<0&&(num=0),$amount.text(num),0==result.winNumber)Alert.show(awardTmpl({msg:"TOT",tip:"不是不中奖，只是缘分少了点~",isGoods:!1}),!0,"award-alert");else if(Alert.show(function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div id="J-award-panel" class="award-panel">\r\n	<p class="award-msg">'+(null==(__t=msg)?"":__t)+'</p>\r\n	<p class="award-tip">'+(null==(__t=tip)?"":__t)+'</p>\r\n	<div class="btn-wrap">\r\n		',__p+=isGoods?'\r\n		<button class="J-drop-btn btnl btnl-default">放弃领取</button>\r\n		<a class="J-goods-yes btnl btnl-lq">确认领取</a>\r\n		':'\r\n		<button class="J-yes-btn btnl">确认</button>\r\n		',__p+="\r\n	</div>\r\n</div>";return __p}({msg:"恭喜您！抽中了"+result.msg,tip:"人品大爆炸啦~",isGoods:3==result.type}),!(3==type),"award-alert"),1==type){var $score=$("#J-scroe-num");$score.text(result.score+ +$score.text())}$(".J-goods-yes").on("click",function(){location.href=result.awardUrl}),$(".J-drop-btn, .J-yes-btn").on("click",function(){Alert.hide()})}})}var Ajax=require("common/ajax/index"),Alert=require("common/alert/alert"),Tabs=require("common/tabs/index"),Bubble=require("common/bubble/bubble"),prizeDeg=[80,40,360,318,278,238,200,159,119],awardTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div id="J-award-panel" class="award-panel">\r\n	<p class="award-msg">'+(null==(__t=msg)?"":__t)+'</p>\r\n	<p class="award-tip">'+(null==(__t=tip)?"":__t)+'</p>\r\n	<div class="btn-wrap">\r\n		',__p+=isGoods?'\r\n		<button class="J-drop-btn btnl btnl-default">放弃领取</button>\r\n		<a class="J-goods-yes btnl btnl-lq">确认领取</a>\r\n		':'\r\n		<button class="J-yes-btn btnl">确认</button>\r\n		',__p+="\r\n	</div>\r\n</div>";return __p},awarding=!1;init()});
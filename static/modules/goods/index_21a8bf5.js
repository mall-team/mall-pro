define("goods/index",function(n){function t(){function n(){setTimeout(function(){return e--,S.text(e),0>=e?(V=!1,void S.text("获取验证码").removeClass("disabled")):void n()},1e3)}if(V)return!1;var t=C.val(),e=60;return(new p).send({url:"/WeChat/Band/sendMsg",data:{phone:t}},function(){V=!0,S.text(e).addClass("disabled"),n()}),!1}function e(n){n.preventDefault();var t,e=C.val(),a=j.val();return e?/^\d{11}$/.test(e)?a?(t={phone:e,code:a},void f.start(e,a,p,function(n){n&&(t.recommend=n),(new p).send({url:"/WeChat/Band/bandAccount",type:"post",data:t},function(){D.hidden(),"cart"==D.type?r():u()})})):(v.show("请输入验证码"),!1):(v.show("请输入正确的手机号码"),!1):(v.show("请输入您的手机号码"),!1)}function a(){D.init(),o(),b.init()}function o(){l("#J-btn-cart").on(c,function(n){D.show("cart"),n.preventDefault()}),l("#J-btn-buy").on(c,function(n){D.show("buy"),n.preventDefault()}),l("#J-make-money").on("click",i)}function i(n){function t(){(new p).send({url:"/Mall/Goods/goodsShareMoney"},function(n){var t=n.hasPermission;phpdata.isLogin=1,1==t?J.show():location.href=e.attr("href")})}n.preventDefault();var e=l(this);return phpdata&&1!=phpdata.isLogin?(g.show({Ajax:p,loginSuc:function(){t()}}),!1):(t(),!1)}function r(){if(l("#spe_id").val()>0&&0==l("#spe_already_start").val())return!1;var n=l("#gid").val(),t=s(),e=parseInt(l("#J-cm-amount").find(".amount-val").text(),10),a=l("#J-ajaxurl-addCart").val(),o={goodsId:n,skuAttr:t.skuAttr,skuValue:t.skuValue,amount:e};(new p).send({url:a,data:o,type:"post"},function(){v.show("加入购物车成功"),d()})}function u(){var n=l("#gid").val(),t=s(),e=parseInt(l("#J-cm-amount").find(".amount-val").text(),10);if(parseInt(l("#J-last-num").text())<e)return void v.show("库存不足，下次早点哦!");var a=l("#J-ajaxurl-quickBuy").val(),o={goodsId:n,skuAttr:t.skuAttr,skuValue:t.skuValue,amount:e};(new p).send({url:a,data:o,type:"post",selfSucBack:!0},function(n,t){var e='<form action="'+t.url+'" method="post">';l.each(o,function(n,t){"tjzAjax"!=n&&(e+='<input type="hidden" name="'+n+'" value="'+t+'" />')}),e+="</form>",l(e).appendTo(l("body")).submit()})}function s(){var n=[],t=l("#J-cm").find("dt"),e=l("#J-cm").find("dd");t.each(function(t,a){var o=(l(a),l(e[t]));n.push(o.find(".sel").text())});var a,o=l("#goods_sku_json").val(),i={};try{a=JSON.parse(o)}catch(r){return}for(var u=0;u<a.length;u++)if(n[0]==a[u].skuValue){i=a[u];break}return{skuId:i.skuId,skuAttr:i.skuAttr,skuValue:i.skuValue,price:i.price,amount:i.amount}}function d(){var n=l("#J-ajaxurl-initCart").val();n&&(new p).send({url:n},function(n){var t=+n.number,e=l("#J-cart-num");t>0?e.text(t).parent().css("display","block"):e.parent().css("display","none")})}var c="click",l=n("zepto"),m=n("common/swiper/index"),f=n("common/confirm-service/index"),p=(n("common/config/index"),n("common/ajax/index")),v=n("common/bubble/bubble"),h=n("common/guide/guide"),k=n("common/util/index"),x=n("common/amount/index"),g=(n("common/alert/alert"),n("common/login-pop/index")),y=new x,b=n("common/comment-section/index");n("common/gotop/index");var J=new h;k.phpdataReady(function(){var n=l("#J-share");"undefined"==typeof taojinzi?new h(n):n.on("click",function(){taojinzi.share(JSON.stringify({title:title,link:link,imgUrl:imgUrl,desc:desc}))})});var w=l("#J-phone-ok2"),C=l("#phone2"),j=l("#code2"),S=l("#J-yzm-bt2"),_=l(window).height();new m({container:"banner",pager:"bannerPager"}),k.phpdataReady(function(n){var a=n.isLogin;0==a&&(l("#J-panel-cm").addClass("add-phone"),S.on("click",t),w.on("click",e))});var A=k.getParam("minnum"),D={type:"",init:function(){var n=this,t=l("#J-panel-cm"),e=t.find(".close"),a=t.find(".mask"),o=t.find(".J-ok");t.on("click",function(){return!1}),e.on(c,function(t){n.hidden(),t.preventDefault()}),a.on(c,function(t){n.hidden(),t.preventDefault()}),o.on(c,function(t){n.hidden(),"cart"==n.type?r():u(),t.preventDefault()}),n._initSel()},_initSel:function(){var n=this;n._resetSku(),y.init(),l("#J-cm").delegate("label",c,function(t){var e=l(t.target);e.siblings("label").removeClass("sel"),e.addClass("sel"),e.siblings("input").val(e.attr("value")),n._resetSku(),y.resetBtn()})},_resetSku:function(){var n=s(),t=l(".J-amount-bar");l("#J-last-num").text(n.amount),t.attr("max",n.amount),l("#J-sku-price").text(n.price)},show:function(n){var t=l("#J-panel-cm"),e=(t.find(".mask"),t.find(".panel-content"));this.type=n,t.find(".amount-val").text(A?A:1),y.resetBtn(),l("html").attr("style","position: relative; overflow: hidden; height: "+_+"px;"),l("body").attr("style","overflow: hidden; height: "+_+"px; padding: 0px;"),t.css("display","block"),e.animate({translateY:"0"},300,"ease-out")},hidden:function(){var n=l("#J-panel-cm"),t=(n.find(".mask"),n.find(".panel-content"));t.animate({translateY:"100%"},300,"ease-in",function(){l("html").attr("style",""),l("body").attr("style",""),n.css("display","none")})}},I={init:function(){var n=l("#J-cart-num"),t=+n.text();t&&t>0?n.addClass("has-num"):n.removeClass("has-num")},add:function(n){var t=l("#J-cart-num"),e=+t.text();t.text(e+n).addClass("has-num")}};I.init();var V=!1;window.jumpurl=location.href,a(),setTimeout(function(){d()},0)});
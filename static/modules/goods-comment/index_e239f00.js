define("goods-comment/index",function(require,exports,module){function init(){addEvent(),initPage()}function addEvent(){$("#J-discuss-list").on("click",".img-list > li",previewImg)}function initPage(){new PageLoader({container:"#J-discuss-list",getHtml:function(pageNum,back){lastPageNum=pageNum,(new Ajax).send({url:"/Mall/Goods/moreComment",data:{g:getParam("g"),page:pageNum,type:1}},function(result){var list=result.commentlist.data;list&&(curDataLen=list.length),back&&back(function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",$.each(list,function(n,t){__p+='\r\n<li>\r\n	<div class="img-wrap" style="background-image:url('+(null==(__t=t.head_sculpture)?"":__t)+')"></div>\r\n	<div class="info">\r\n		<div class="name-wrap">\r\n			<label class="name">'+(null==(__t=t.customer_name)?"":__t)+'</label>\r\n			<span item-id="'+(null==(__t=t.id)?"":__t)+'" class="yes-bar '+(null==(__t=t.isSupport?"active":"")?"":__t)+'"><i class="icon-yes"></i><b>'+(null==(__t=t.comment_praise_num)?"":__t)+'</b></span>\r\n		</div>\r\n		<div class="star-wrap">\r\n			<div class="star-bar">\r\n				<div class="star-gray"></div>\r\n				<div class="star-inner" style="width:'+(null==(__t=t.product_score/5*100)?"":__t)+'%;">\r\n					<div class="star-active"></div>\r\n				</div>\r\n			</div>\r\n			<span class="date">'+(null==(__t=t.create_time)?"":__t)+'</span>\r\n		</div>\r\n		<p class="cotent">'+(null==(__t=t.comment_content)?"":__t)+"</p>\r\n		",t.imgList&&t.imgList.length>0&&(__p+='\r\n		<ul class="img-list">\r\n			',$.each(t.imgList,function(n,t){__p+='\r\n			<li style="background-image:url('+(null==(__t=t)?"":__t)+')"></li>\r\n			'}),__p+="\r\n		</ul>\r\n		"),__p+="\r\n		",$.each(t.reply,function(n,e){__p+='\r\n		<p class="cotent-replay"><b>'+(null==(__t=e.reply_user)?"":__t)+"</b>回复<b>"+(null==(__t=t.customer_name)?"":__t)+"</b>："+(null==(__t=e.back_content)?"":__t)+"</p>\r\n		"}),__p+="\r\n	</div>\r\n</li>\r\n"}),__p+="";return __p}({list:list}),result.commentlist.total_num)})}}).loadFirst().loadEnd(function(){lastPageNum>1?Bubble.show("亲，没有评价了~"):0==curDataLen&&($("#J-discuss-list").css("display","none"),$("#J-nodata").css("display","block"))})}function previewImg(){var n=$(this),t=[],e=0;n.parent().children().each(function(a,i){n[0]==i&&(e=a),t.push($(i).css("background-image").match(/url\((.*)\)/)[1])}),Preview.show(t,e)}function getParam(n){var t=new RegExp("(^|&)"+n+"=([^&]*)(&|$)","i"),e=location.search,a=e.substr(1).match(t);return e&&a?a[2]:""}var $=require("zepto"),Ajax=require("common/ajax/index"),PageLoader=require("common/page-loader/index"),Bubble=require("common/bubble/bubble"),Preview=require("common/preview/index"),lastPageNum=1,curDataLen=0;init()});
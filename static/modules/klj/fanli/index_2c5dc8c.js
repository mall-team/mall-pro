define("klj/fanli/index",function(require,exports,module){function init(){return isLogin?(addEvent(),void($managerList.length>0?initManagerList():initPageLoader())):void LoginPop.show({Ajax:Ajax,loginSuc:function(){location.reload()}})}function addEvent(){$("#J-nopay-list, #J-pay-list").on("click","li",showPop),$("#J-gen-link").on("click",genLink),$("#J-rule-btn").on("click",showRule)}function showRule(){Alert.show($("#J-rule-tmpl").html())}function genLink(){var n=$("#J-phone-num").val();return n?/^\d{11}$/.test(n)?void(new Ajax).send({url:"/Activity/Home/makeUrl",data:{phone:n}},function(n){$("#J-url-text").text(n.url)}):void Bubble.show("您输入的手机号格式有误！"):void Bubble.show("请先输入手机号！")}function initPageLoader(){var containerId,_tmpl,type=Util.getParam("type")||"1";switch(type){case"1":containerId="#J-pay-list",_tmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",$.each(list,function(n,t){__p+='\r\n<li tel="'+(null==(__t=t.cellphone)?"":__t)+'" \r\n	',1==t.canChat&&(__p+='\r\n	chart-href="/User/Customer/single?touser='+(null==(__t=t.customer_id)?"":__t)+'"\r\n	'),__p+='\r\n	>\r\n	<div class="img-wrap" \r\n	',t.head_sculpture&&(__p+='\r\n	style="background-image: url('+(null==(__t=t.head_sculpture)?"":__t)+')"\r\n	'),__p+='\r\n	></div>\r\n	<div class="info">\r\n		<p class="name">'+(null==(__t=t.nickname)?"":__t)+"\r\n			",__p+="1"==t.state1?'\r\n			<span class="state complete">已发奖</span>\r\n			':'\r\n			<span class="state doing">未发奖</span>\r\n			',__p+='\r\n		</p>\r\n		<p class="time">'+(null==(__t=t.create_time)?"":__t)+'支付</p>\r\n	</div>\r\n	<div class="btn-wrap">\r\n		',__p+=1==t.canChat?'\r\n		<a class="btn-contact">联系他</a>\r\n		':'\r\n		<a class="btn-contact disabled">联系他</a>\r\n		',__p+="\r\n	</div>\r\n</li>\r\n"}),__p+="";return __p};break;case"2":containerId="#J-nopay-list",_tmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",$.each(list,function(n,t){__p+='\r\n<li tel="'+(null==(__t=t.cellphone)?"":__t)+'" \r\n	',1==t.canChat&&(__p+='\r\n	chart-href="/User/Customer/single?touser='+(null==(__t=t.customer_id)?"":__t)+'"\r\n	'),__p+='>\r\n	<div class="img-wrap" \r\n	',t.head_sculpture&&(__p+='\r\n	style="background-image: url('+(null==(__t=t.head_sculpture)?"":__t)+')"\r\n	'),__p+='\r\n	></div>\r\n	<div class="info">\r\n		<p class="name">'+(null==(__t=t.nickname)?"":__t)+"\r\n			",__p+=t.order_id?'\r\n			<span class="state complete">未支付</span>\r\n			':'\r\n			<span class="state doing">未下单</span>\r\n			',__p+='\r\n		</p>\r\n		<p class="time">'+(null==(__t=t.create_time)?"":__t)+'</p>\r\n	</div>\r\n	<div class="btn-wrap">\r\n		',__p+=1==t.canChat?'\r\n		<a class="btn-contact">联系他</a>\r\n		':'\r\n		<a class="btn-contact disabled">联系他</a>\r\n		',__p+="\r\n	</div>\r\n</li>\r\n"}),__p+="";return __p}}new PageLoader({container:containerId,seeMore:".see-more",pageBegin:2,loading:".J-more-loading",getHtml:function(n,t){(new Ajax).send({url:"/Activity/Home/purchasedFriends",data:{page:n,type:type}},function(n){t&&t(_tmpl({list:n}))})}}).loadEnd(function(){Bubble.show("亲，没有更多数据了~"),$(".see-more").remove()})}function showPop(){var $cur=$(this),tel=$cur.attr("tel"),chartHref=$cur.attr("chart-href"),_tmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="contact-panel">\r\n	<div class="title">联系方式</div>\r\n	<div class="btn-wrap">\r\n		',chartHref&&(__p+='\r\n		<a href="'+(null==(__t=chartHref)?"":__t)+'" class="btnl btnl-wx">聊一聊</a>\r\n		'),__p+='\r\n		<a href="tel:'+(null==(__t=tel)?"":__t)+'" class="btnl btnl-default">打电话</a>\r\n		<a href="sms:'+(null==(__t=tel)?"":__t)+'" class="btnl btnl-default">发短信</a>\r\n	</div>\r\n</div>';return __p};$cur.parent().children(".active").removeClass("active"),$cur.addClass("active"),Pop.show({scroll:!0,content:_tmpl({tel:tel,chartHref:chartHref})})}function initManagerList(){var _tmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",$.each(list,function(n,t){__p+='\r\n<li>\r\n	<div class="img-wrap" \r\n	',t.head_sculpture&&(__p+='\r\n	style="background-image: url('+(null==(__t=t.head_sculpture)?"":__t)+')"\r\n	'),__p+='\r\n	></div>\r\n	<div class="info">\r\n		<p class="name">'+(null==(__t=t.nickname)?"":__t)+'</p>\r\n		<p class="time">'+(null==(__t=t.create_time)?"":__t)+'</p>\r\n	</div>\r\n	<div class="amount">推荐<b>'+(null==(__t=t.num)?"":__t)+"</b>人</div>\r\n</li>\r\n"}),__p+="";return __p};new PageLoader({container:"#J-manager-list",seeMore:".see-more",pageBegin:2,loading:".J-more-loading",getHtml:function(n,t){(new Ajax).send({url:"/Activity/Home/getPartnerData",data:{page:n}},function(n){t&&t(_tmpl({list:n}))})}}).loadEnd(function(){Bubble.show("亲，没有更多数据了~"),$(".see-more").remove()})}var $=require("zepto"),Bubble=require("common/bubble/bubble"),Pop=require("common/pop/index"),PageLoader=require("common/page-loader/index"),Ajax=require("common/ajax/index"),Util=require("common/util/index"),LoginPop=require("common/login-pop/index"),Alert=require("common/alert/alert"),$managerList=$("#J-manager-list"),isLogin=!("undefined"!=typeof phpdata&&0==phpdata.isLogin);init()});